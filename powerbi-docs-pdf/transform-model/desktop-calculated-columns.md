---
title: ใช้คอลัมน์จากการคำนวณใน Power BI Desktop
description: คอลัมน์จากการคำนวณใน Power BI Desktop
author: davidiseminger
ms.author: davidi
ms.reviewer: ''
ms.service: powerbi
ms.subservice: pbi-transform-model
ms.topic: how-to
ms.date: 05/07/2019
LocalizationGroup: Model your data
ms.openlocfilehash: 9c7285f90b963166c643c2bb20f9323eddb7ce85
ms.sourcegitcommit: 653e18d7041d3dd1cf7a38010372366975a98eae
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 12/01/2020
ms.locfileid: "96415944"
---
# <a name="create-calculated-columns-in-power-bi-desktop"></a><span data-ttu-id="bba1e-103">สร้างคอลัมน์จากการคำนวณใน Power BI Desktop</span><span class="sxs-lookup"><span data-stu-id="bba1e-103">Create calculated columns in Power BI Desktop</span></span>
<span data-ttu-id="bba1e-104">คุณสามารถใช้คอลัมน์จากการคำนวณเพื่อเพิ่มข้อมูลใหม่ลงในตารางที่มีอยู่แล้วในแบบจำลองของคุณ</span><span class="sxs-lookup"><span data-stu-id="bba1e-104">With calculated columns, you can add new data to a table already in your model.</span></span> <span data-ttu-id="bba1e-105">แต่แทนที่จะจัดทำคิวรีและโหลดค่าจากแหล่งข้อมูลลงในคอลัมน์ใหม่ของคุณ คุณสามารถสร้างสูตรนิพจน์การวิเคราะห์ข้อมูล (DAX) ที่กำหนดค่าของคอลัมน์ได้</span><span class="sxs-lookup"><span data-stu-id="bba1e-105">But instead of querying and loading values into your new column from a data source, you create a Data Analysis Expressions (DAX) formula that defines the column's values.</span></span> <span data-ttu-id="bba1e-106">ใน Power BI Desktop คอลัมน์จากการคำนวณถูกสร้างขึ้นโดยใช้คุณลักษณะคอลัมน์ใหม่ในมุมมอง **รายงาน**</span><span class="sxs-lookup"><span data-stu-id="bba1e-106">In Power BI Desktop, calculated columns are created by using the new column feature in **Report** view.</span></span>

<span data-ttu-id="bba1e-107">ซึ่งต่างจากคอลัมน์แบบกำหนดเองที่สร้างขึ้นเป็นส่วนหนึ่งของการคิวรีโดย **เพิ่มคอลัมน์แบบกำหนดเอง** ในเครื่องมือแก้ไขคิวรี คอลัมน์จากการคำนวณที่สร้างขึ้นในมุมมอง **รายงาน** หรือมุมมอง **ข้อมูล** จะอ้างอิงตามข้อมูลที่คุณได้โหลดลงในแบบจำลองแล้ว</span><span class="sxs-lookup"><span data-stu-id="bba1e-107">Unlike custom columns that are created as part of a query by using **Add Custom Column** in Query Editor, calculated columns that are created in **Report** view or **Data** view are based on data you've already loaded into the model.</span></span> <span data-ttu-id="bba1e-108">ตัวอย่างเช่น คุณอาจเลือกเชื่อมค่าจากคอลัมน์ที่แตกต่างกันสองคอลัมน์ในตารางที่เกี่ยวข้องเข้าด้วยกันในตารางสองตารางที่แตกต่างกันแต่เกี่ยวข้องกัน ทำการบวกเพิ่มหรือแยกสตริงย่อย</span><span class="sxs-lookup"><span data-stu-id="bba1e-108">For example, you might choose to concatenate values from two different columns in two different but related tables, do addition, or extract substrings.</span></span>

<span data-ttu-id="bba1e-109">คอลัมน์จากการคำนวณที่คุณสร้างขึ้นปรากฏในรายการ **เขตข้อมูล** เช่นเดียวกับเขตข้อมูลอื่น ๆ แต่คอลัมน์เหล่านี้จะมีไอคอนพิเศษที่แสดงว่าค่านั้นเป็นผลลัพธ์ของสูตร</span><span class="sxs-lookup"><span data-stu-id="bba1e-109">Calculated columns you create appear in the **Fields** list just like any other field, but they'll have a special icon showing its values are the result of a formula.</span></span> <span data-ttu-id="bba1e-110">คุณสามารถตั้งชื่อคอลัมน์ของคุณได้ตามต้องการ และเพิ่มคอลัมน์เหล่านั้นลงในการจัดรูปแบบการแสดงข้อมูลในรายงานเช่นเดียวกับเขตข้อมูลอื่น ๆ</span><span class="sxs-lookup"><span data-stu-id="bba1e-110">You can name your columns whatever you want, and add them to a report visualization just like other fields.</span></span>

![ภาพหน้าจอของ Power B I Desktop ที่แสดงคอลัมน์จากการคำนวณในมุมมองเขตข้อมูล](media/desktop-calculated-columns/calccolinpbid_fields.png)
 
<span data-ttu-id="bba1e-112">คอลัมน์จากการคำนวณจะคำนวณผลลัพธ์โดยใช้ DAX ซึ่งเป็นภาษาสูตรที่มีไว้เพื่อทำงานกับข้อมูลเชิงสัมพันธ์อย่างเช่นใน Power BI Desktop</span><span class="sxs-lookup"><span data-stu-id="bba1e-112">Calculated columns calculate results by using DAX, a formula language meant to work with relational data like in Power BI Desktop.</span></span> <span data-ttu-id="bba1e-113">DAX มีไลบรารีของฟังก์ชัน ตัวดำเนินการ และโครงสร้างมากกว่า 200</span><span class="sxs-lookup"><span data-stu-id="bba1e-113">DAX includes a library of over 200 functions, operators, and constructs.</span></span> <span data-ttu-id="bba1e-114">ซึ่งมีความยืดหยุ่นมากในการสร้างสูตรเพื่อคำนวณผลลัพธ์สำหรับการวิเคราะห์ข้อมูลใด ๆ ที่ต้องการ</span><span class="sxs-lookup"><span data-stu-id="bba1e-114">It provides immense flexibility in creating formulas to calculate results for just about any data analysis need.</span></span> <span data-ttu-id="bba1e-115">เมื่อต้องการเรียนรู้เพิ่มเติมเกี่ยวกับ DAX โปรดดูที่ [พื้นฐาน DAX ใน Power BI Desktop](desktop-quickstart-learn-dax-basics.md)</span><span class="sxs-lookup"><span data-stu-id="bba1e-115">To learn more about DAX, see [DAX basics in Power BI Desktop](desktop-quickstart-learn-dax-basics.md).</span></span>

<span data-ttu-id="bba1e-116">สูตร DAX จะคล้ายกับสูตร Excel</span><span class="sxs-lookup"><span data-stu-id="bba1e-116">DAX formulas are similar to Excel formulas.</span></span> <span data-ttu-id="bba1e-117">อันที่จริงแล้ว DAX มีหลายฟังก์ชันที่เหมือนกันกับ Excel</span><span class="sxs-lookup"><span data-stu-id="bba1e-117">In fact, DAX has many of the same functions as Excel.</span></span> <span data-ttu-id="bba1e-118">อย่างไรก็ตาม ฟังก์ชัน DAX มีไว้เพื่อทำงานบนข้อมูลที่แบ่งเป็นส่วนๆ หรือกรองแบบมีการโต้ตอบในรายงาน เช่น ใน Power BI Desktop</span><span class="sxs-lookup"><span data-stu-id="bba1e-118">DAX functions, however, are meant to work over data interactively sliced or filtered in a report, like in Power BI Desktop.</span></span> <span data-ttu-id="bba1e-119">ใน Excel คุณสามารถมีสูตรที่แตกต่างกันสำหรับแต่ละแถวในตาราง</span><span class="sxs-lookup"><span data-stu-id="bba1e-119">In Excel, you can have a different formula for each row in a table.</span></span> <span data-ttu-id="bba1e-120">ใน Power BI เมื่อคุณสร้างสูตร DAX สำหรับคอลัมน์ใหม่ จะมีการคำนวณผลลัพธ์สำหรับทุกแถวในตาราง</span><span class="sxs-lookup"><span data-stu-id="bba1e-120">In Power BI, when you create a DAX formula for a new column, it will calculate a result for every row in the table.</span></span> <span data-ttu-id="bba1e-121">ค่าของคอลัมน์จะถูกคำนวณใหม่ตามที่จำเป็น เช่น เมื่อมีการรีเฟรชข้อมูลเบื้องต้นและมีการเปลี่ยนแปลงค่า</span><span class="sxs-lookup"><span data-stu-id="bba1e-121">Column values are recalculated as necessary, like when the underlying data is refreshed and values have changed.</span></span>

## <a name="lets-look-at-an-example"></a><span data-ttu-id="bba1e-122">มาลองดูตัวอย่างกัน</span><span class="sxs-lookup"><span data-stu-id="bba1e-122">Let's look at an example</span></span>
<span data-ttu-id="bba1e-123">Jeff เป็นผู้จัดการฝ่ายจัดส่งสินค้าที่ Contoso และต้องการสร้างรายงานที่แสดงจำนวนการจัดส่งสินค้าไปที่เมืองต่าง ๆ</span><span class="sxs-lookup"><span data-stu-id="bba1e-123">Jeff is a shipping manager at Contoso, and wants to create a report showing the number of shipments to different cities.</span></span> <span data-ttu-id="bba1e-124">Jeff มีตาราง **ภูมิศาสตร์** ที่มีเขตข้อมูลแยกต่างหากสำหรับเมืองและรัฐ</span><span class="sxs-lookup"><span data-stu-id="bba1e-124">Jeff has a **Geography** table with separate fields for city and state.</span></span> <span data-ttu-id="bba1e-125">แต่ Jeff ต้องการให้รายงานของตนแสดงค่าเมืองและรัฐเป็นค่าเดียวบนแถวเดียวกัน</span><span class="sxs-lookup"><span data-stu-id="bba1e-125">But, Jeff wants their reports to show the city and state values as a single value on the same row.</span></span> <span data-ttu-id="bba1e-126">ในตอนนี้ ตาราง **ภูมิศาสตร์** ของเจฟฟ์ไม่มีเขตข้อมูลที่ต้องการ</span><span class="sxs-lookup"><span data-stu-id="bba1e-126">Right now, Jeff's **Geography** table doesn't have the wanted field.</span></span>

![ภาพหน้าจอของ Power B I Desktop ที่แสดงตัวกรองภูมิศาสตร์ในมุมมองเขตข้อมูล](media/desktop-calculated-columns/calccolinpbid_cityandstatefields.png)

<span data-ttu-id="bba1e-128">แต่ด้วยคอลัมน์จากการคำนวณ Jeff จึงสามารถเชื่อมข้อมูลเมืองจากคอลัมน์ **City** เข้ามาไว้ด้วยกันกับรัฐจากคอลัมน์ **State** ได้</span><span class="sxs-lookup"><span data-stu-id="bba1e-128">But with a calculated column, Jeff can put together the cities from the **City** column with the states from the **State** column.</span></span>

<span data-ttu-id="bba1e-129">Jeff คลิกขวาที่ตาราง **ภูมิศาสตร์** และจากนั้นก็คลิกที่ **คอลัมน์ใหม่**</span><span class="sxs-lookup"><span data-stu-id="bba1e-129">Jeff right clicks on the **Geography** table and then selects **New Column**.</span></span> <span data-ttu-id="bba1e-130">แล้ว Jeff จึงใส่สูตร DAX ดังต่อไปนี้ลงในแถบสูตร:</span><span class="sxs-lookup"><span data-stu-id="bba1e-130">Jeff then enters the following DAX formula into the formula bar:</span></span>

![ภาพหน้าจอของ Power BI Desktop ที่แสดงการป้อนข้อมูลสูตร DAX](media/desktop-calculated-columns/calccolinpbid_formula.png)

<span data-ttu-id="bba1e-132">สูตรนี้เพียงแค่สร้างคอลัมน์ใหม่ที่ชื่อว่า **CityState**</span><span class="sxs-lookup"><span data-stu-id="bba1e-132">This formula simply creates a new column named **CityState**.</span></span> <span data-ttu-id="bba1e-133">สำหรับแต่ละแถวในตาราง **ภูมิศาสตร์** ก็จะใช้ค่าจากคอลัมน์ **City** เพิ่มเครื่องหมายจุลภาคและช่องว่าง แล้วจึงเชื่อมค่าจากคอลัมน์ **State** เข้าไว้ด้วยกัน</span><span class="sxs-lookup"><span data-stu-id="bba1e-133">For each row in the **Geography** table, it takes values from the **City** column, adds a comma and a space, and then concatenates values from the **State** column.</span></span>

<span data-ttu-id="bba1e-134">ในตอนนี้ Jeff มีเขตข้อมูลที่ต้องการแล้ว</span><span class="sxs-lookup"><span data-stu-id="bba1e-134">Now Jeff has the wanted field.</span></span>

![ภาพหน้าจอของ Power B I Desktop ที่แสดงว่ามีการเลือก CityState ในตัวกรองภูมิศาสตร์ของมุมมองเขตข้อมูล](media/desktop-calculated-columns/calccolinpbid_citystatefield.png)

<span data-ttu-id="bba1e-136">ตอนนี้ Jeff สามารถเพิ่มเขตข้อมูลในพื้นที่รายงานพร้อมกับจำนวนการจัดส่งสินค้า</span><span class="sxs-lookup"><span data-stu-id="bba1e-136">Jeff can now add it to the report canvas along with the number of shipments.</span></span> <span data-ttu-id="bba1e-137">ด้วยความพยายามที่น้อยที่สุด ตอนนี้ Jeff มีเขตข้อมูล **CityState** ที่สามารถเพิ่มเพื่อจัดรูปแบบการแสดงข้อมูลไม่ว่าชนิดใดก็ตามได้</span><span class="sxs-lookup"><span data-stu-id="bba1e-137">With minimal effort, Jeff now has a **CityState** field that can be added to just about any type of visualization.</span></span> <span data-ttu-id="bba1e-138">เมื่อ Jeff สร้างแผนที่ใหม่ Power BI Desktop ก็จะทราบวิธีการอ่านค่าเมืองและรัฐในคอลัมน์ใหม่แล้ว</span><span class="sxs-lookup"><span data-stu-id="bba1e-138">When Jeff creates a new map, Power BI Desktop already knows how to read the city and state values in the new column.</span></span>

![ภาพหน้าจอของ Power B I Desktop ที่แสดงข้อมูลซึ่งนำเสนอในวิชวลแผนที่](media/desktop-calculated-columns/calccolinpbid_citystatemap.png)

## <a name="next-steps"></a><span data-ttu-id="bba1e-140">ขั้นตอนถัดไป</span><span class="sxs-lookup"><span data-stu-id="bba1e-140">Next steps</span></span>
<span data-ttu-id="bba1e-141">ในส่วนนี้ เราจะแนะนำเกี่ยวกับคอลัมน์จากการคำนวณอย่างคร่าว ๆ เท่านั้น</span><span class="sxs-lookup"><span data-stu-id="bba1e-141">We've only provided a quick introduction to calculated columns here.</span></span> <span data-ttu-id="bba1e-142">สำหรับข้อมูลเพิ่มเติม โปรดดูทรัพยากรต่อไปนี้:</span><span class="sxs-lookup"><span data-stu-id="bba1e-142">For more information, check out the following resources:</span></span>

* <span data-ttu-id="bba1e-143">หากต้องการดาวน์โหลดไฟล์ตัวอย่าง และดูบทเรียนทีละขั้นตอนเกี่ยวกับวิธีการสร้างคอลัมน์เพิ่มเติม โปรดดู[บทช่วยสอน สร้างคอลัมน์จากการคำนวณใน Power BI Desktop](desktop-tutorial-create-calculated-columns.md)</span><span class="sxs-lookup"><span data-stu-id="bba1e-143">To download a sample file and get step-by-step lessons on how to create more columns, see [Tutorial: Create calculated columns in Power BI Desktop](desktop-tutorial-create-calculated-columns.md)</span></span>

* <span data-ttu-id="bba1e-144">เมื่อต้องการเรียนรู้เพิ่มเติมเกี่ยวกับ DAX โปรดดูที่ [พื้นฐาน DAX ใน Power BI Desktop](desktop-quickstart-learn-dax-basics.md)</span><span class="sxs-lookup"><span data-stu-id="bba1e-144">To learn more about DAX, see [DAX basics in Power BI Desktop](desktop-quickstart-learn-dax-basics.md).</span></span>

* <span data-ttu-id="bba1e-145">เมื่อต้องการเรียนรู้เพิ่มเติมเกี่ยวกับคอลัมน์ที่คุณสร้างขึ้นเป็นส่วนหนึ่งของการคิวรี โปรดดูที่หัวข้อ **สร้างคอลัมน์แบบกำหนดเอง** ใน [งานการคิวรีทั่วไปใน Power BI Desktop](desktop-common-query-tasks.md)</span><span class="sxs-lookup"><span data-stu-id="bba1e-145">To learn more about columns you create as part of a query, see the **Create custom columns** section in [Common query tasks in Power BI Desktop.](desktop-common-query-tasks.md)</span></span>  

