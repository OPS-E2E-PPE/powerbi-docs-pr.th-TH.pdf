---
title: ใช้งานคิวรีที่ใช้บ่อยใน Power BI Desktop
description: ใช้งานคิวรีที่ใช้บ่อยใน Power BI Desktop
author: davidiseminger
ms.author: davidi
ms.reviewer: ''
ms.service: powerbi
ms.subservice: pbi-transform-model
ms.topic: how-to
ms.date: 01/09/2020
LocalizationGroup: Transform and shape data
ms.openlocfilehash: 2346118350ca589a25635db9da976fa917e3ff7b
ms.sourcegitcommit: 653e18d7041d3dd1cf7a38010372366975a98eae
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 12/01/2020
ms.locfileid: "96415967"
---
# <a name="perform-common-query-tasks-in-power-bi-desktop"></a><span data-ttu-id="0f584-103">ใช้งานคิวรีที่ใช้บ่อยใน Power BI Desktop</span><span class="sxs-lookup"><span data-stu-id="0f584-103">Perform common query tasks in Power BI Desktop</span></span>

<span data-ttu-id="0f584-104">ในหน้าต่างตัวแก้ไข  Power Query ของ Power BI Desktop มีงานที่ใช้บ่อยอยู่จำนวนหนึ่ง</span><span class="sxs-lookup"><span data-stu-id="0f584-104">In the Power Query Editor window of Power BI Desktop, there are a handful of commonly used tasks.</span></span> <span data-ttu-id="0f584-105">บทความนี้จะสาธิตงานที่ใช้บ่อยเหล่านั้น และให้ลิงก์สำหรับข้อมูลเพิ่มเติม</span><span class="sxs-lookup"><span data-stu-id="0f584-105">This article demonstrates those common tasks and provides links for additional information.</span></span>

<span data-ttu-id="0f584-106">งานคิวรีที่ใช้บ่อยซึ่งจะสาธิตที่นี่ คือ:</span><span class="sxs-lookup"><span data-stu-id="0f584-106">The common query tasks demonstrated here are:</span></span>

* <span data-ttu-id="0f584-107">เชื่อมต่อกับข้อมูล</span><span class="sxs-lookup"><span data-stu-id="0f584-107">Connect to data</span></span>
* <span data-ttu-id="0f584-108">จัดรูปร่างและรวมข้อมูล</span><span class="sxs-lookup"><span data-stu-id="0f584-108">Shape and combine data</span></span>
* <span data-ttu-id="0f584-109">จัดกลุ่มแถว</span><span class="sxs-lookup"><span data-stu-id="0f584-109">Group rows</span></span>
* <span data-ttu-id="0f584-110">Pivot คอลัมน์</span><span class="sxs-lookup"><span data-stu-id="0f584-110">Pivot columns</span></span>
* <span data-ttu-id="0f584-111">สร้างคอลัมน์แบบกำหนดเอง</span><span class="sxs-lookup"><span data-stu-id="0f584-111">Create custom columns</span></span>
* <span data-ttu-id="0f584-112">คิวรีสูตร</span><span class="sxs-lookup"><span data-stu-id="0f584-112">Query formulas</span></span>

<span data-ttu-id="0f584-113">เราจะใช้การเชื่อมต่อข้อมูลบางตัวเพื่อทำงานเหล่านี้ให้สำเร็จ</span><span class="sxs-lookup"><span data-stu-id="0f584-113">We’ll use a few data connections to complete these tasks.</span></span> <span data-ttu-id="0f584-114">เรามีข้อมูลให้คุณดาวน์โหลดหรือการเชื่อมต่อ กรณีที่คุณต้องการลองขั้นตอนเหล่านี้ด้วยตนเอง</span><span class="sxs-lookup"><span data-stu-id="0f584-114">The data is available for you to download or connect to, in case you want to step through these tasks yourself.</span></span>

<span data-ttu-id="0f584-115">การเชื่อมต่อข้อมูลแรก คือ [เวิร์กบุ๊ก Excel](https://download.microsoft.com/download/5/7/0/5701F78F-C3C2-450C-BCCE-AAB60C31051D/PBI_Edu_ELSi_Enrollment_v2.xlsx) ซึ่งสามารถดาวน์โหลดและบันทึกลงในเครื่องของคุณได้</span><span class="sxs-lookup"><span data-stu-id="0f584-115">The first data connection is [an Excel workbook](https://download.microsoft.com/download/5/7/0/5701F78F-C3C2-450C-BCCE-AAB60C31051D/PBI_Edu_ELSi_Enrollment_v2.xlsx), which you can download and save locally.</span></span> <span data-ttu-id="0f584-116">นอกจากนี้ยังมีแหล่งข้อมูลเว็บที่ใช้ในบทความ Power BI Desktop อื่นๆ:</span><span class="sxs-lookup"><span data-stu-id="0f584-116">The other is a Web resource that's also used in other Power BI Desktop articles:</span></span>

<https://www.bankrate.com/retirement/best-and-worst-states-for-retirement/>

<span data-ttu-id="0f584-117">งานคิวรีที่ใช้บ่อยเริ่มต้นที่ขั้นตอนที่จำเป็นสำหรับการเชื่อมต่อแหล่งข้อมูลทั้งสองนั้น</span><span class="sxs-lookup"><span data-stu-id="0f584-117">Common query tasks begin at the steps necessary to connect to both of those data sources.</span></span>

## <a name="connect-to-data"></a><span data-ttu-id="0f584-118">เชื่อมต่อกับข้อมูล</span><span class="sxs-lookup"><span data-stu-id="0f584-118">Connect to data</span></span>

<span data-ttu-id="0f584-119">เพื่อเชื่อมต่อกับข้อมูลใน Power BI Desktop ให้เลือก **หน้าหลัก** จากนั้น **รับข้อมูล**</span><span class="sxs-lookup"><span data-stu-id="0f584-119">To connect to data in Power BI Desktop, select **Home** and then **Get Data**.</span></span> <span data-ttu-id="0f584-120">Power BI Desktop จะแสดงเมนูให้เห็นแหล่งข้อมูลที่ใช้บ่อยที่สุด</span><span class="sxs-lookup"><span data-stu-id="0f584-120">Power BI Desktop presents a menu with the most common data sources.</span></span> <span data-ttu-id="0f584-121">สำหรับรายการทั้งหมดของแหล่งข้อมูลซึ่ง Power BI Desktopสามารถเชื่อมต่อได้  เลือก **เพิ่มเติม** ที่ท้ายสุดของเมนู</span><span class="sxs-lookup"><span data-stu-id="0f584-121">For a complete list of data sources to which Power BI Desktop can connect, select **More** at the end of the menu.</span></span> <span data-ttu-id="0f584-122">สำหรับข้อมูลเพิ่มเติม ดู [แหล่งข้อมูลใน Power BI Desktop](../connect-data/desktop-data-sources.md)</span><span class="sxs-lookup"><span data-stu-id="0f584-122">For more information, see [Data sources in Power BI Desktop](../connect-data/desktop-data-sources.md).</span></span>

![เมนูแหล่งข้อมูลทั่วไปส่วนใหญ่ ปุ่มรับข้อมูล Power BI Desktop](media/desktop-common-query-tasks/commonquerytasks_getdata.png)

<span data-ttu-id="0f584-124">เพื่อเริ่มต้น เลือก **Excel** จากนั้นระบุเวิร์กบุ๊ก Excel ที่กล่าวถึงไปก่อนหน้า แล้วจึงเลือก **เปิด**</span><span class="sxs-lookup"><span data-stu-id="0f584-124">To start, select **Excel**, specify the Excel workbook mentioned earlier, and then select **Open**.</span></span> <span data-ttu-id="0f584-125">คิวรีจะตรวจสอบเวิร์กบุ๊ก แล้วแสดงข้อมูลที่พบในกล่องโต้ตอบ **ตัวนำทาง** หลังจากที่คุณเลือกตาราง</span><span class="sxs-lookup"><span data-stu-id="0f584-125">Query inspects the workbook, then presents the data it found in the **Navigator** dialog box after you select a table.</span></span>

![แหล่งข้อมูล Excel กล่องโต้ตอบตัวนำทาง รับข้อมูล Power BI Desktop](media/desktop-common-query-tasks/commonquerytasks_navigator.png)

<span data-ttu-id="0f584-127">คุณสามารถเลือก **แปลงข้อมูล** เพื่อแก้ไข ปรับเปลี่ยน  หรือ *จัดรูปร่าง* ข้อมูลก่อนที่จะโหลดลงใน Power BI Desktop ได้</span><span class="sxs-lookup"><span data-stu-id="0f584-127">You can select **Transform Data** to edit, adjust, or *shape*, the data before you load it into Power BI Desktop.</span></span> <span data-ttu-id="0f584-128">การแก้ไขจะมีประโยชน์โดยเฉพาะอย่างยิ่งเมื่อคุณทำงานกับชุดข้อมูลขนาดใหญ่ที่คุณต้องการตัดออกก่อนการโหลด</span><span class="sxs-lookup"><span data-stu-id="0f584-128">Editing is especially useful when you work with large datasets that you want to pare down before loading.</span></span>

<span data-ttu-id="0f584-129">การเชื่อมต่อกับข้อมูลชนิดอื่นๆ เป็นเรื่องง่ายพอกัน</span><span class="sxs-lookup"><span data-stu-id="0f584-129">Connecting to different types of data is as easy.</span></span> <span data-ttu-id="0f584-130">คุณยังต้องการเชื่อมต่อไปยังแหล่งข้อมูลเว็บ</span><span class="sxs-lookup"><span data-stu-id="0f584-130">You also want to connect to a Web resource.</span></span> <span data-ttu-id="0f584-131">เลือก **รับข้อมูล** > **เพิ่มเติม** จากนั้นเลือก **อื่นๆ** > **เว็บ** > **เชื่อมต่อ**</span><span class="sxs-lookup"><span data-stu-id="0f584-131">Choose **Get Data** > **More**, and then select **Other** > **Web** > **Connect**.</span></span>

![แหล่งข้อมูลเว็บ กล่องโต้ตอบรับข้อมูล Power BI Desktop](media/desktop-common-query-tasks/commonquerytasks_getdata_other.png)

<span data-ttu-id="0f584-133">กล่องโต้ตอบ **จากเว็บ** จะปรากฏขึ้น ซึ่งคุณสามารถกรอก URL ของหน้าเว็บลงไปได้</span><span class="sxs-lookup"><span data-stu-id="0f584-133">The **From Web** dialog box appears, where you can type in the URL of the Web page.</span></span>

![จากกล่องโต้ตอบรับข้อมูล แหล่งข้อมูลเว็บ รับข้อมูล Power BI Desktop](media/desktop-common-query-tasks/datasources_fromwebbox.png)

<span data-ttu-id="0f584-135">เลือก **ตกลง**</span><span class="sxs-lookup"><span data-stu-id="0f584-135">Select **OK**.</span></span> <span data-ttu-id="0f584-136">เช่นเดียวกัน Power BI Desktop จะตรวจสอบข้อมูลหน้าเว็บและแสดงตัวเลือกการแสดงตัวอย่างในกล่องโต้ตอบ **ตัวนำทาง**</span><span class="sxs-lookup"><span data-stu-id="0f584-136">Like before, Power BI Desktop inspects the Web page data and shows preview options in the **Navigator** dialog box.</span></span> <span data-ttu-id="0f584-137">เมื่อคุณเลือกตาราง จะแสดงตัวอย่างของข้อมูล</span><span class="sxs-lookup"><span data-stu-id="0f584-137">When you select a table, it displays a preview of the data.</span></span>

<span data-ttu-id="0f584-138">การเชื่อมต่อข้อมูลอื่น ๆ ก็ทำงานคล้ายกัน</span><span class="sxs-lookup"><span data-stu-id="0f584-138">Other data connections are similar.</span></span> <span data-ttu-id="0f584-139">ถ้าจำเป็นต้องรับรองความถูกต้องเพื่อทำการเชื่อมต่อข้อมูล Power BI Desktop จะถามให้คุณใส่ข้อมูลประจำตัว</span><span class="sxs-lookup"><span data-stu-id="0f584-139">If authentication is required to make a data connection, Power BI Desktop prompts you for the appropriate credentials.</span></span>

<span data-ttu-id="0f584-140">สำหรับการสาธิตแต่ละขั้นตอนของการเชื่อมต่อข้อมูลใน Power BI Desktop ดู [เชื่อมต่อข้อมูลใน Power BI Desktop](../connect-data/desktop-connect-to-data.md)</span><span class="sxs-lookup"><span data-stu-id="0f584-140">For a step-by-step demonstration of connecting to data in Power BI Desktop, see [Connect to data in Power BI Desktop](../connect-data/desktop-connect-to-data.md).</span></span>

## <a name="shape-and-combine-data"></a><span data-ttu-id="0f584-141">จัดรูปร่างและรวมข้อมูล</span><span class="sxs-lookup"><span data-stu-id="0f584-141">Shape and combine data</span></span>

<span data-ttu-id="0f584-142">คุณสามารถจัดรูปร่างและรวมข้อมูลได้อย่างง่ายดายด้วยตัวแก้ไข Power Query</span><span class="sxs-lookup"><span data-stu-id="0f584-142">You can easily shape and combine data with Power Query Editor.</span></span> <span data-ttu-id="0f584-143">ส่วนนี้จะให้ตัวอย่างสองสามตัวว่าคุณจะจัดรูปร่างข้อมูลได้อย่างไร</span><span class="sxs-lookup"><span data-stu-id="0f584-143">This section includes a few examples of how you can shape data.</span></span> <span data-ttu-id="0f584-144">สำหรับการสาธิตแบบครบถ้วนเพิ่มเติมของการจัดรูปร่างและรวมข้อมูล ดู [จัดรูปร่างและรวมข้อมูลด้วย Power BI Desktop](../connect-data/desktop-shape-and-combine-data.md)</span><span class="sxs-lookup"><span data-stu-id="0f584-144">For a more complete demonstration of shaping and combining data, see [Shape and combine Data with Power BI Desktop](../connect-data/desktop-shape-and-combine-data.md).</span></span>

<span data-ttu-id="0f584-145">ในส่วนก่อนหน้านี้ คุณได้เชื่อมต่อชุดข้อมูลสองชุด: เวิร์กบุ๊ก Excel และแหล่งข้อมูลเว็บ</span><span class="sxs-lookup"><span data-stu-id="0f584-145">In the previous section, you connected to two sets of data: an Excel workbook and a Web resource.</span></span> <span data-ttu-id="0f584-146">หลังจากที่มีการโหลดข้อมูลไปในตัวแก้ไข Power Query แล้ว ให้เลือกคิวรีหน้าเว็บจากคิวรีที่พร้อมใช้งานในบานหน้าต่าง **คิวรี** ดังแสดงไว้ที่นี่:</span><span class="sxs-lookup"><span data-stu-id="0f584-146">After the data is loaded in Power Query Editor, select the Web page query from the available queries in the **Queries** pane, as shown here:</span></span>

![บานหน้าต่างคิวรี ตัวแก้ไข Power Query Power BI Desktop](media/desktop-common-query-tasks/commonquerytasks_querypaneloaded.png)

<span data-ttu-id="0f584-148">การจัดรูปร่างข้อมูล หมายถึงการแปลงแหล่งข้อมูลให้อยู่ในฟอร์มและรูปแบบที่ตรงตามความต้องการของคุณ</span><span class="sxs-lookup"><span data-stu-id="0f584-148">When you shape data, you transform a data source into the form and format that meets your needs.</span></span>

<span data-ttu-id="0f584-149">ในตัวแก้ไข Power Query สามารถพบหลายคำสั่ง ribbon และในเมนูบริบท</span><span class="sxs-lookup"><span data-stu-id="0f584-149">In Power Query Editor, many commands can be found in the ribbon, and in context menus.</span></span> <span data-ttu-id="0f584-150">ตัวอย่างเช่น เมื่อคุณคลิกขวาที่คอลัมน์ เมนูบริบทจะให้คุณลบคอลัมน์ออกได้</span><span class="sxs-lookup"><span data-stu-id="0f584-150">For example, when you right-click a column, the context menu lets you remove the column.</span></span> <span data-ttu-id="0f584-151">นอกจากนี้คุณยังสามารถเลือกคอลัมน์จากนั้นเลือกปุ่ม **ลบคอลัมน์** จากแท็บ **หน้าแรก** ใน Ribbon</span><span class="sxs-lookup"><span data-stu-id="0f584-151">You may also select a column and then select the **Remove Columns** button from the **Home** tab in the ribbon.</span></span>

![ลบคำสั่งคอลัมน์ ตัวแก้ไข Power Query Power BI Desktop ออก](media/desktop-common-query-tasks/commonquerytasks_removecolumns.png)

<span data-ttu-id="0f584-153">คุณสามารถจัดรูปร่างข้อมูลในหลากหลายวิธีในคิวรีนี้ได้</span><span class="sxs-lookup"><span data-stu-id="0f584-153">You can shape the data in many other ways in this query.</span></span> <span data-ttu-id="0f584-154">คุณอาจลบจำนวนแถวจากด้านบนหรือด้านล่าง</span><span class="sxs-lookup"><span data-stu-id="0f584-154">You may remove any number of rows from the top or bottom.</span></span> <span data-ttu-id="0f584-155">หรือคุณอาจเพิ่มคอลัมน์ แยกคอลัมน์ แทนที่ค่า และการจัดรูปร่างอื่นๆ ได้</span><span class="sxs-lookup"><span data-stu-id="0f584-155">Or you may add columns, split columns, replace values, and do other shaping tasks.</span></span> <span data-ttu-id="0f584-156">ด้วยคุณลักษณะเหล่านี้ คุณสามารถจัดการตัวแก้ไข Power Query เพื่อรับข้อมูลในแบบคุณต้องการ</span><span class="sxs-lookup"><span data-stu-id="0f584-156">With these features, you can direct Power Query Editor to get the data how you want it.</span></span>

## <a name="group-rows"></a><span data-ttu-id="0f584-157">จัดกลุ่มแถว</span><span class="sxs-lookup"><span data-stu-id="0f584-157">Group rows</span></span>

<span data-ttu-id="0f584-158">ในตัวแก้ไข Power Query คุณสามารถจัดกลุ่มค่าจากแถวจำนวนมากรวมเป็นค่าเดียวได้</span><span class="sxs-lookup"><span data-stu-id="0f584-158">In Power Query Editor, you can group the values from many rows into a single value.</span></span> <span data-ttu-id="0f584-159">คุณลักษณะนี้จะเป็นประโยชน์เมื่อทำการสรุปจำนวนผลิตภัณฑ์ที่เสนอ ยอดขายทั้งหมด หรือการนับจำนวนนักเรียน</span><span class="sxs-lookup"><span data-stu-id="0f584-159">This feature can be useful when summarizing the number of products offered, the total sales, or the count of students.</span></span>

<span data-ttu-id="0f584-160">ในตัวอย่างนี้ คุณจะจัดกลุ่มในชุดข้อมูลการลงทะเบียนการศึกษา</span><span class="sxs-lookup"><span data-stu-id="0f584-160">In this example, you group rows in an education enrollment dataset.</span></span> <span data-ttu-id="0f584-161">ข้อมูลมาจากเวิร์กบุ๊ก Excel</span><span class="sxs-lookup"><span data-stu-id="0f584-161">The data is from the Excel workbook.</span></span> <span data-ttu-id="0f584-162">มีการจัดรูปร่างในตัวแก้ไข Power Query เพื่อให้ได้เฉพาะคอลัมน์ที่คุณต้องการ เปลี่ยนชื่อตาราง และทำการแปลงอื่นๆ</span><span class="sxs-lookup"><span data-stu-id="0f584-162">It's been shaped in Power Query Editor to get just the columns you need, rename the table, and make a few other transforms.</span></span>

<span data-ttu-id="0f584-163">มาหาคำตอบกันว่าแต่ละรัฐมีหน่วยงานมากเท่าใด</span><span class="sxs-lookup"><span data-stu-id="0f584-163">Let’s find out how many Agencies each state has.</span></span> <span data-ttu-id="0f584-164">(หน่วยงานสามารถรวมถึงเขตโรงเรียน หน่วยงานการศึกษาอื่นๆ เช่น เขตพื้นที่บริการภูมิภาค และอีกมากมาย) เลือกคอลัมน์ **ID ของหน่วยงาน - NCES ที่ได้รับมอบหมาย \[เขต\]ปีล่าสุดที่มี** จากนั้นเลือกปุ่ม **จัดกลุ่มตาม** ในแท็บ **การแปลง** หรือแท็บ **หน้าแรก** ของ ribbon</span><span class="sxs-lookup"><span data-stu-id="0f584-164">(Agencies can include school districts, other education agencies such as regional service districts, and more.) Select the **Agency ID - NCES Assigned \[District\] Latest available year** column, then select the **Group By** button in the **Transform** tab or the **Home** tab of the ribbon.</span></span> <span data-ttu-id="0f584-165">(**จัดกลุ่มตาม** พร้อมใช้งานในทั้งสองแท็บ)</span><span class="sxs-lookup"><span data-stu-id="0f584-165">(**Group By** is available in both tabs.)</span></span>

![สกรีนช็อตจะแสดงวิธีการจัดกลุ่มแถวในตาราง](media/desktop-common-query-tasks/commonquerytasks_groupby.png)

<span data-ttu-id="0f584-167">กล่องโต้ตอบ **จัดกลุ่มตาม** จะปรากฏขึ้น</span><span class="sxs-lookup"><span data-stu-id="0f584-167">The **Group By** dialog box appears.</span></span> <span data-ttu-id="0f584-168">เมื่อตัวแก้ไข Power Query จัดกลุ่มแถว จะมีการสร้างคอลัมน์ใหม่เพื่อวางผลลัพธ์จากการ **จัดกลุ่มตาม** </span><span class="sxs-lookup"><span data-stu-id="0f584-168">When Power Query Editor groups rows, it creates a new column into which it places the **Group By** results.</span></span> <span data-ttu-id="0f584-169">คุณสามารถปรับเปลี่ยนการดำเนินการของ **จัดกลุ่มตาม** ดังต่อไปนี้:</span><span class="sxs-lookup"><span data-stu-id="0f584-169">You can adjust the **Group By** operation in the following ways:</span></span>

1. <span data-ttu-id="0f584-170">รายการแบบดรอปดาวน์ที่ไม่มีป้ายชื่อจะระบุคอลัมน์ที่จะจัดกลุ่ม</span><span class="sxs-lookup"><span data-stu-id="0f584-170">The unlabeled dropdown list specifies the column to be grouped.</span></span> <span data-ttu-id="0f584-171">ตัวแก้ไข Power Query ตั้งค่าเริ่มต้นนี้ไปยังคอลัมน์ที่เลือกไว้ แต่คุณสามารถเปลี่ยนเป็นคอลัมน์ใดก็ได้ในตาราง</span><span class="sxs-lookup"><span data-stu-id="0f584-171">Power Query Editor defaults this value to the selected column, but you can change it to be any column in the table.</span></span>
2. <span data-ttu-id="0f584-172">**ชื่อคอลัมน์ใหม่**: ตัวแก้ไข Power Query จะแนะนำชื่อสำหรับคอลัมน์ใหม่ ตามการดำเนินการที่จะใช้จัดกลุ่มคอลัมน์ </span><span class="sxs-lookup"><span data-stu-id="0f584-172">**New column name**: Power Query Editor suggests a name for the new column, based on the operation it applies to the column being grouped.</span></span> <span data-ttu-id="0f584-173">แต่คุณก็สามารถตั้งชื่อคอลัมน์ใหม่เป็นอะไรก็ได้ตามที่คุณต้องการ</span><span class="sxs-lookup"><span data-stu-id="0f584-173">You can name the new column anything you want, though.</span></span>
3. <span data-ttu-id="0f584-174">**การดำเนินการ**: คุณอาจเลือกการดำเนินการที่ตัวแก้ไข Power Query เช่น **ผลรวม** **ค่าเฉลี่ย** หรือ **นับจำนวนแถวที่แตกต่างกัน**</span><span class="sxs-lookup"><span data-stu-id="0f584-174">**Operation**: You may choose the operation that Power Query Editor applies, such as **Sum**, **Median**, or **Count Distinct Rows**.</span></span> <span data-ttu-id="0f584-175">ค่าเริ่มต้นคือ **นับจำนวนแถว**</span><span class="sxs-lookup"><span data-stu-id="0f584-175">The default value is **Count Rows**.</span></span>
4. <span data-ttu-id="0f584-176">**เพิ่มการจัดกลุ่ม** และ **เพิ่มการรวมกลุ่ม**: ปุ่มเหล่านี้จะพร้อมใช้งานเฉพาะเมื่อคุณเลือกตัวเลือก **ขั้นสูง**</span><span class="sxs-lookup"><span data-stu-id="0f584-176">**Add grouping** and **Add aggregation**: These buttons are available only if you select the **Advanced** option.</span></span> <span data-ttu-id="0f584-177">ในการดำเนินการเดียว คุณสามารถสร้างการดำเนินการจัดกลุ่ม (การดำเนินการ **จัดกลุ่มตาม**) ในหลายคอลัมน์และสร้างการรวมหลายรายการโดยใช้ปุ่มเหล่านี้</span><span class="sxs-lookup"><span data-stu-id="0f584-177">In a single operation, you can make grouping operations (**Group By** actions) on many columns and create several aggregations using these buttons.</span></span> <span data-ttu-id="0f584-178"> ตัวแก้ไข Power Query จะสร้างคอลัมน์ใหม่ที่ดำเนินการบนหลายๆ คอลัมน์ โดยอิงตามที่คุณได้เลือกไว้ในกล่องโต้ตอบนี้</span><span class="sxs-lookup"><span data-stu-id="0f584-178">Based on your selections in this dialog box, Power Query Editor creates a new column that operates on multiple columns.</span></span>

<span data-ttu-id="0f584-179">เลือก **เพิ่มการจัดกลุ่ม** หรือ **เพิ่มการรวมกลุ่ม** เพื่อเพิ่มการจัดกลุ่มหรือการรวมกลุ่มไปยังการดำเนินการใน **จัดกลุ่มตาม**</span><span class="sxs-lookup"><span data-stu-id="0f584-179">Select **Add grouping** or **Add aggregation** to add more groupings or aggregations to a **Group By** operation.</span></span> <span data-ttu-id="0f584-180">ในการลบการจัดกลุ่มหรือการรวมกลุ่มออก ให้เลือกไอคอนจุดไข่ปลา ( **...** ) ทางด้านขวาของแถว จากนั้น **ลบ**</span><span class="sxs-lookup"><span data-stu-id="0f584-180">To remove a grouping or aggregation, select the ellipsis icon (**...**) to the right of the row, and then **Delete**.</span></span> <span data-ttu-id="0f584-181">เอาเลย ลองใช้การดำเนินการ **จัดกลุ่มตาม** โดยใช้ค่าเริ่มต้นเพื่อดูว่าจะเกิดอะไรขึ้น</span><span class="sxs-lookup"><span data-stu-id="0f584-181">Go ahead and try the **Group By** operation using the default values to see what occurs.</span></span>

![สกรีนช็อตจะแสดงกล่องโต้ตอบจัดกลุ่มตาม พร้อมข้อความ เพิ่มการจัดกลุ่ม และ เพิ่มการรวม](media/desktop-common-query-tasks/commonquerytasks_groupbynumbered.png)

<span data-ttu-id="0f584-183">เมื่อคุณเลือก **ตกลง** คิวรีจะดำเนินการ **จัดกลุ่มตาม** และส่งผลลัพธ์กลับมา</span><span class="sxs-lookup"><span data-stu-id="0f584-183">When you select **OK**, Query does the **Group By** operation and returns the results.</span></span> <span data-ttu-id="0f584-184">ว้าว ดูนั่นสิ – รัฐ โอไฮโอ เท็กซัส อิลลินอยส์ และแคลิฟอร์เนีย ตอนนี้แต่ละรัฐมีหน่วยงานมากกว่าหนึ่งพันหน่วยงาน</span><span class="sxs-lookup"><span data-stu-id="0f584-184">Whew, look at that – Ohio, Illinois, Texas, and California now each have over a thousand agencies!</span></span>

![นับจำนวนคอลัมน์ จัดกลุ่มตามการดำเนินการ ตัวแก้ไข Power Query Power BI Desktop](media/desktop-common-query-tasks/commonquerytasks_groupedresult.png)

<span data-ttu-id="0f584-186">และด้วยตัวแก้ไข Power Query คุณสามารถลบการดำเนินการปรับแต่งครั้งล่าสุดได้เสมอ</span><span class="sxs-lookup"><span data-stu-id="0f584-186">And with Power Query Editor, you can always remove the last shaping operation.</span></span> <span data-ttu-id="0f584-187">ในบานหน้าต่าง **การตั้งค่าคิวรี** ภายใต้ขั้นตอน **ที่ใช้** เพียงแค่เลือก **X** ถัดจากขั้นตอนล่าสุดที่เสร็จสิ้นไป</span><span class="sxs-lookup"><span data-stu-id="0f584-187">In the **Query Settings** pane, under **Applied Steps**, just select the **X** next to the step recently completed.</span></span> <span data-ttu-id="0f584-188">เอาเลย ลองทำดู</span><span class="sxs-lookup"><span data-stu-id="0f584-188">So go ahead and experiment.</span></span> <span data-ttu-id="0f584-189">ถ้าคุณยังไม่ถูกใจกับผลลัพธ์ ให้ทำซ้ำขั้นตอน จนกว่าตัวแก้ไข Power Query จะจัดรูปร่างข้อมูลในแบบที่คุณต้องการ</span><span class="sxs-lookup"><span data-stu-id="0f584-189">If you don’t like the results, redo the step until Power Query Editor shapes your data the way you want.</span></span>

## <a name="pivot-columns"></a><span data-ttu-id="0f584-190">Pivot คอลัมน์</span><span class="sxs-lookup"><span data-stu-id="0f584-190">Pivot columns</span></span>

<span data-ttu-id="0f584-191">คุณสามารถ pivot คอลัมน์และสร้างตารางที่มีค่าที่รวมกลุ่มแล้ว สำหรับค่าเฉพาะแต่ละค่าในคอลัมน์</span><span class="sxs-lookup"><span data-stu-id="0f584-191">You can pivot columns and create a table that contains aggregated values for each unique value in a column.</span></span> <span data-ttu-id="0f584-192">ตัวอย่างเช่น เพื่อหาว่ามีจำนวนสินค้าที่แตกต่างกันเท่าใดในแต่ละประเภทของสินค้า คุณสามารถสร้างตารางเพื่อหาคำตอบได้อย่างรวดเร็ว</span><span class="sxs-lookup"><span data-stu-id="0f584-192">For example, to find out how many different products are in each product category, you can quickly create a table to do that.</span></span>

<span data-ttu-id="0f584-193">มาลองดูตัวอย่างกัน</span><span class="sxs-lookup"><span data-stu-id="0f584-193">Let’s look at an example.</span></span> <span data-ttu-id="0f584-194">ตาราง **Products_by_Categories** ต่อไปนี้ ได้รับการจัดรูปร่าง เพื่อแสดงเฉพาะผลิตภัณฑ์ที่มีเอกลักษณ์แต่ละผลิตภัณฑ์ (ตามชื่อ) และประเภทที่ผลิตภัณฑ์ถูกจัดเอาไว้</span><span class="sxs-lookup"><span data-stu-id="0f584-194">The following **Products_by_Categories** table has been shaped to only show each unique product (by name), and which category each product falls under.</span></span> <span data-ttu-id="0f584-195">เพื่อสร้างตารางใหม่ที่แสดงการนับจำนวนผลิตภัณฑ์ในแต่ละประเภท (ตามคอลัมน์ **CategoryName**) เลือกคอลัมน์นั้น แล้วเลือก **แปลง** > **คอลัมน์ Pivot**</span><span class="sxs-lookup"><span data-stu-id="0f584-195">To create a new table that shows a count of products for each category (based on the **CategoryName** column), select the column, then select **Transform** > **Pivot Column**.</span></span>

![คำสั่ง Pivot คอลัมน์ ตัวแก้ไข Power Query Power BI Desktop](media/desktop-common-query-tasks/pivotcolumns_pivotbutton.png)

<span data-ttu-id="0f584-197">กล่องโต้ตอบ **Pivot คอลัมน์** จะปรากฏขึ้น เพื่อให้คุณทราบว่าค่าของคอลัมน์ใดที่จะนำไปใช้สร้างคอลัมน์ใหม่ (1)</span><span class="sxs-lookup"><span data-stu-id="0f584-197">The **Pivot Column** dialog box appears, letting you know which column’s values will be used to create new columns (1).</span></span> <span data-ttu-id="0f584-198">(หากชื่อคอลัมน์ **CategoryName** ที่คุณต้องการไม่ปรากฏขึ้น ให้เลือกจากรายการดรอปดาวน์ เมื่อคุณขยาย **ตัวเลือกขั้นสูง** (2) คุณสามารถเลือกฟังก์ชันที่จะนำไปใช้กับค่าที่รวมกลุ่มได้ (3)</span><span class="sxs-lookup"><span data-stu-id="0f584-198">(If the wanted column name of **CategoryName** isn't shown, select it from the dropdown list.) When you expand **Advanced options** (2), you can select the function that will be applied to the aggregated values (3).</span></span>

![กล่องโต้ตอบ Pivot คอลัมน์ ตัวแก้ไข Power Query Power BI Desktop](media/desktop-common-query-tasks/pivotcolumns_pivotdialog.png)

<span data-ttu-id="0f584-200">เมื่อคุณเลือก **ตกลง** คิวรีจะแสดงตารางตามคำสั่งการแปลงที่ให้ไว้ในกล่องโต้ตอบ **คอลัมน์ Pivot**</span><span class="sxs-lookup"><span data-stu-id="0f584-200">When you select **OK**, Query displays the table according to the transform instructions provided in the **Pivot Column** dialog box.</span></span>

![ผลลัพธ์ Pivot คอลัมน์ ตัวแก้ไข Power Query Power BI Desktop](media/desktop-common-query-tasks/pivotcolumns_pivotcomplete.png)

## <a name="create-custom-columns"></a><span data-ttu-id="0f584-202">สร้างคอลัมน์แบบกำหนดเอง</span><span class="sxs-lookup"><span data-stu-id="0f584-202">Create custom columns</span></span>

<span data-ttu-id="0f584-203">ในตัวแก้ไข Power Query คุณสามารถสร้างสูตรแบบกำหนดเองที่ทำงานได้ในหลายคอลัมน์ในตารางของคุณ</span><span class="sxs-lookup"><span data-stu-id="0f584-203">In Power Query Editor, you can create custom formulas that operate on multiple columns in your table.</span></span> <span data-ttu-id="0f584-204">จากนั้นคุณจึงวางผลลัพธ์จากสูตรเหล่านั้นลงในคอลัมน์ (แบบกำหนดเอง) ใหม่</span><span class="sxs-lookup"><span data-stu-id="0f584-204">Then you may place the results of such formulas into a new (custom) column.</span></span> <span data-ttu-id="0f584-205">ตัวแก้ไข Power Query ทำให้การสร้างคอลัมน์แบบกำหนดเองเป็นไปได้ง่ายขึ้น</span><span class="sxs-lookup"><span data-stu-id="0f584-205">Power Query Editor makes it easy to create custom columns.</span></span>

<span data-ttu-id="0f584-206">ด้วยข้อมูลในเวิร์กบุ๊ก Excel ในตัวแก้ไข Power Query ไปที่แท็บ **เพิ่มคอลัมน์** บน ribbon แล้วเลือก **คอลัมน์แบบกำหนดเอง**</span><span class="sxs-lookup"><span data-stu-id="0f584-206">With the Excel workbook data in Power Query Editor, go to the **Add Column** tab on the ribbon, and then select **Custom Column**.</span></span>

![เพิ่มคำสั่งคอลัมน์แบบกำหนดเอง ตัวแก้ไข Power Query Power BI Desktop](media/desktop-common-query-tasks/commonquerytasks_customcolumn.png)

<span data-ttu-id="0f584-208">กล่องโต้ตอบต่อไปนี้จะปรากฏขึ้น:</span><span class="sxs-lookup"><span data-stu-id="0f584-208">The following dialog box appears.</span></span> <span data-ttu-id="0f584-209">ในตัวอย่างนี้ เราจะสร้างคอลัมน์แบบกำหนดเองชื่อว่า *Percent ELL* ที่คำนวณเปอร์เซ็นต์ของนักเรียนทั้งหมดที่เป็นผู้เรียนภาษาอังกฤษ (English Language Learners, ELL)</span><span class="sxs-lookup"><span data-stu-id="0f584-209">In this example, create a custom column called *Percent ELL* that calculates the percentage of total students that are English Language Learners (ELL).</span></span>

![กล่องโต้ตอบคอลัมน์แบบกำหนดเอง ตัวแก้ไข Power Query Power BI Desktop](media/desktop-common-query-tasks/customcolumn_addcustomcolumndialog.png)

<span data-ttu-id="0f584-211">เช่นเดียวกับขั้นตอนอื่นๆ ที่ใช้ในตัวแก้ไข Power Query ถ้าคอลัมน์แบบกำหนดเองใหม่นั้นไม่ได้ให้ข้อมูลที่คุณกำลังค้นหา คุณสามารถลบขั้นตอนออกได้</span><span class="sxs-lookup"><span data-stu-id="0f584-211">As with any other applied step in Power Query Editor, if the new custom column doesn’t provide the data you’re looking for, you can delete the step.</span></span> <span data-ttu-id="0f584-212">ในบานหน้าต่าง **การตั้งค่าคิวรี** ภายใต้ **ขั้นตอนที่ใช้** เพียงแค่เลือก **X** ถัดจากขั้นตอน **แบบกำหนดเองที่เพิ่ม**</span><span class="sxs-lookup"><span data-stu-id="0f584-212">In the **Query Settings** pane, under **Applied Steps**, just select the **X** next to the **Added Custom** step.</span></span>

![ขั้นตอนที่ใช้ บานหน้าต่างการตั้งค่าคิวรี ตัวแก้ไข Power Query  Power BI Desktop](media/desktop-common-query-tasks/customcolumn_addedappliedstep.png)

## <a name="query-formulas"></a><span data-ttu-id="0f584-214">คิวรีสูตร</span><span class="sxs-lookup"><span data-stu-id="0f584-214">Query formulas</span></span>

<span data-ttu-id="0f584-215">คุณสามารถแก้ไขขั้นตอนที่ตัวแก้ไข Power Query สร้างขึ้นได้</span><span class="sxs-lookup"><span data-stu-id="0f584-215">You can edit the steps that Power Query Editor generates.</span></span> <span data-ttu-id="0f584-216">คุณยังสามารถสร้างสูตรแบบกำหนดเองซึ่งช่วยให้คุณเชื่อมต่อและจัดรูปร่างข้อมูลของคุณได้แม่นยำยิ่งขึ้น</span><span class="sxs-lookup"><span data-stu-id="0f584-216">You can also create custom formulas, which let you connect to and shape your data more precisely.</span></span> <span data-ttu-id="0f584-217">เมื่อใดก็ตามที่ตัวแก้ไข Power Query มีการดำเนินการกับข้อมูล สูตรที่เกี่ยวข้องกับการดำเนินการนั้นจะแสดงอยู่ในแถบสูตร</span><span class="sxs-lookup"><span data-stu-id="0f584-217">Whenever Power Query Editor does an action on data, the formula associated with the action is displayed in the formula bar.</span></span> <span data-ttu-id="0f584-218">เมื่อต้องการดูแถบสูตร ไปที่แท็บ **มุมมอง** ของ ribbon จากนั้นเลือก **แถบสูตร**</span><span class="sxs-lookup"><span data-stu-id="0f584-218">To view the formula bar, go to the **View** tab of the ribbon, and then select **Formula Bar**.</span></span>

![ตัวเลือกแถบสูตร ตัวแก้ไข Power Query Power BI Desktop](media/desktop-common-query-tasks/queryformulas_formulabar.png)

<span data-ttu-id="0f584-220">ตัวแก้ไข Power Query จะเก็บขั้นตอนที่นำไปใช้แล้ว ในแต่ละคิวรีให้อยู่ในรูปข้อความที่คุณสามารถดูหรือแก้ไขได้</span><span class="sxs-lookup"><span data-stu-id="0f584-220">Power Query Editor keeps all applied steps for each query as text that you can view or modify.</span></span> <span data-ttu-id="0f584-221">คุณสามารถดูหรือแก้ไขข้อความสำหรับคิวรีใดๆ ได้โดยใช้ **เครื่องมือแก้ไขขั้นสูง**</span><span class="sxs-lookup"><span data-stu-id="0f584-221">You can view or modify the text for any query using the **Advanced Editor**.</span></span> <span data-ttu-id="0f584-222">เพียงเลือก **มุมมอง** จากนั้น **เครื่องมือแก้ไขขั้นสูง**</span><span class="sxs-lookup"><span data-stu-id="0f584-222">Just select **View** and then **Advanced Editor**.</span></span>

![คำสั่งเครื่องมือแก้ไขขั้นสูง ตัวแก้ไข Power Query  Power BI Desktop](media/desktop-common-query-tasks/queryformulas_advancededitorbutton.png)

<span data-ttu-id="0f584-224">นี่คือตัวอย่างของ **ตัวแก้ไขขั้นสูง** ที่แสดงขั้นตอนคิวรีที่ใช้กับ **USA\_StudentEnrollment**</span><span class="sxs-lookup"><span data-stu-id="0f584-224">Here's a look at the **Advanced Editor**, with the query steps associated with the **USA\_StudentEnrollment** query displayed.</span></span> <span data-ttu-id="0f584-225">ขั้นตอนเหล่านี้จะถูกสร้างขึ้นในภาษา Power Query Formula Language ซึ่งมักเรียกว่า *M* สำหรับข้อมูล ดูที่ [เรียนรู้เกี่ยวกับสูตร Power Query](https://support.office.com/article/learn-about-power-query-formulas-6bc50988-022b-4799-a709-f8aafdee2b2f)</span><span class="sxs-lookup"><span data-stu-id="0f584-225">These steps are created in the Power Query Formula Language, often referred to as *M*. For more information, see [Learn about Power Query formulas](https://support.office.com/article/learn-about-power-query-formulas-6bc50988-022b-4799-a709-f8aafdee2b2f).</span></span> <span data-ttu-id="0f584-226">เมื่อต้องการดูข้อมูลจำเพาะของภาษาเอง ดูที่ [ข้อมูลจำเพาะของภาษา Power Query M](/powerquery-m/power-query-m-language-specification)</span><span class="sxs-lookup"><span data-stu-id="0f584-226">To view the language specification itself, see [Power Query M language specification](/powerquery-m/power-query-m-language-specification).</span></span>

![กล่องโต้ตอบเครื่องมือแก้ไขขั้นสูง ตัวแก้ไข Power Query  Power BI Desktop](media/desktop-common-query-tasks/queryformulas_advancededitor.png)

<span data-ttu-id="0f584-228">Power BI Desktop มีสูตรคำนวนครอบคลุมหลากหลายประเภท</span><span class="sxs-lookup"><span data-stu-id="0f584-228">Power BI Desktop provides an extensive set of formula categories.</span></span> <span data-ttu-id="0f584-229">สำหรับข้อมูลเพิ่มเติม และแหล่งอ้างอิงแบบสมบูรณ์ของสูตรในตัวแก้ไข Power Query ทั้งหมด ดูที่ [การอ้างอิงฟังก์ชัน Power Query M](/powerquery-m/power-query-m-function-reference)</span><span class="sxs-lookup"><span data-stu-id="0f584-229">For more information, and a complete reference of all Power Query Editor formulas, see [Power Query M function reference](/powerquery-m/power-query-m-function-reference).</span></span>

## <a name="next-steps"></a><span data-ttu-id="0f584-230">ขั้นตอนถัดไป</span><span class="sxs-lookup"><span data-stu-id="0f584-230">Next steps</span></span>

<span data-ttu-id="0f584-231">คุณสามารถทำสิ่งต่างๆ ได้มากมายด้วย Power BI Desktop</span><span class="sxs-lookup"><span data-stu-id="0f584-231">You can do all sorts of things with Power BI Desktop.</span></span> <span data-ttu-id="0f584-232">สำหรับข้อมูลเพิ่มเติมเกี่ยวกับขีดความสามารถ โปรดดูแหล่งข้อมูลต่อไปนี้:</span><span class="sxs-lookup"><span data-stu-id="0f584-232">For more information on its capabilities, see the following resources:</span></span>

* [<span data-ttu-id="0f584-233">Power BI Desktop คืออะไร</span><span class="sxs-lookup"><span data-stu-id="0f584-233">What is Power BI Desktop?</span></span>](../fundamentals/desktop-what-is-desktop.md)
* [<span data-ttu-id="0f584-234">ภาพรวมคิวรีกับ Power BI Desktop</span><span class="sxs-lookup"><span data-stu-id="0f584-234">Query overview with Power BI Desktop</span></span>](desktop-query-overview.md)
* [<span data-ttu-id="0f584-235">แหล่งข้อมูลใน Power BI Desktop</span><span class="sxs-lookup"><span data-stu-id="0f584-235">Data sources in Power BI Desktop</span></span>](../connect-data/desktop-data-sources.md)
* [<span data-ttu-id="0f584-236">เชื่อมต่อกับข้อมูลใน Power BI Desktop</span><span class="sxs-lookup"><span data-stu-id="0f584-236">Connect to data in Power BI Desktop</span></span>](../connect-data/desktop-connect-to-data.md)
* [<span data-ttu-id="0f584-237">จัดรูปร่างและรวมข้อมูลด้วย Power BI Desktop</span><span class="sxs-lookup"><span data-stu-id="0f584-237">Shape and combine data with Power BI Desktop</span></span>](../connect-data/desktop-shape-and-combine-data.md)
