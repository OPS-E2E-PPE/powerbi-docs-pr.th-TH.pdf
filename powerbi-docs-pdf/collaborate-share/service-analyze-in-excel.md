---
title: วิเคราะห์ใน Excel สำหรับ Power BI
description: วิเคราะห์ชุดข้อมูล Power BI ใน Microsoft Excel
author: maggiesMSFT
ms.author: maggies
ms.reviewer: ''
ms.custom: contperf-fy20q4
ms.service: powerbi
ms.subservice: pbi-collaborate-share
ms.topic: how-to
ms.date: 09/22/2020
LocalizationGroup: Reports
ms.openlocfilehash: 4ce463cb82fec7da8d7ec43db7914fb028368bc3
ms.sourcegitcommit: 7bf09116163afaae312eb2b232eb7967baee2c92
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 12/17/2020
ms.locfileid: "97621268"
---
# <a name="analyze-in-excel"></a><span data-ttu-id="51928-103">วิเคราะห์ใน Excel</span><span class="sxs-lookup"><span data-stu-id="51928-103">Analyze in Excel</span></span>
<span data-ttu-id="51928-104">ด้วย **วิเคราะห์ใน Excel** คุณสามารถนำชุดข้อมูล Power BI เข้าสู่ Excel และจากนั้นดูและโต้ตอบกับชุดข้อมูลเหล่านั้นได้โดยใช้ PivotTables แผนภูมิ แบ่งส่วนข้อมูล และคุณลักษณะอื่นๆ ของ Excel</span><span class="sxs-lookup"><span data-stu-id="51928-104">With **Analyze in Excel**, you can bring Power BI datasets into Excel, and then view and interact with them using PivotTables, charts, slicers, and other Excel features.</span></span> <span data-ttu-id="51928-105">เมื่อต้องการใช้ **วิเคราะห์ใน Excel** ก่อนอื่นคุณต้องดาวน์โหลดคุณลักษณะจาก Power BI ทำการติดตั้ง และจากนั้นจึงเลือกชุดข้อมูลอย่างน้อยหนึ่งชุดเพื่อใช้ใน Excel</span><span class="sxs-lookup"><span data-stu-id="51928-105">To use **Analyze in Excel** you must first download the feature from Power BI, install it, and then select one or more datasets to use in Excel.</span></span> 

![วิเคราะห์ใน Excel](media/service-analyze-in-excel/analyze-excel-00a.png)

<span data-ttu-id="51928-107">บทความนี้แสดงวิธีการติดตั้งและใช้การวิเคราะห์ใน Excel อธิบายข้อจำกัด จากนั้นจึงทำตามขั้นตอนถัดไป</span><span class="sxs-lookup"><span data-stu-id="51928-107">This article shows you how to install and use Analyze in Excel, describes its limitations, then provides some next steps.</span></span> <span data-ttu-id="51928-108">ต่อไปนี้เป็นสิ่งที่คุณจะได้เรียนรู้:</span><span class="sxs-lookup"><span data-stu-id="51928-108">Here's what you'll learn:</span></span>

* [<span data-ttu-id="51928-109">ติดตั้งการวิเคราะห์ใน Excel</span><span class="sxs-lookup"><span data-stu-id="51928-109">Install Analyze in Excel</span></span>](#install-analyze-in-excel)
* [<span data-ttu-id="51928-110">เชื่อมต่อกับ Power BI</span><span class="sxs-lookup"><span data-stu-id="51928-110">Connect to Power BI data</span></span>](#connect-to-power-bi-data)
* [<span data-ttu-id="51928-111">ใช้ Excel ในการวิเคราะห์ข้อมูล</span><span class="sxs-lookup"><span data-stu-id="51928-111">Use Excel to analyze the data</span></span>](#use-excel-to-analyze-the-data)
* [<span data-ttu-id="51928-112">การบันทึกและการแชร์เวิร์กบุ๊กของคุณ</span><span class="sxs-lookup"><span data-stu-id="51928-112">Saving and sharing your workbook</span></span>](#saving-and-sharing-your-new-workbook)
* [<span data-ttu-id="51928-113">ข้อกำหนด</span><span class="sxs-lookup"><span data-stu-id="51928-113">Requirements</span></span>](#requirements)

<span data-ttu-id="51928-114">มาสิ เริ่มกระบวนการติดตั้งกันเลย</span><span class="sxs-lookup"><span data-stu-id="51928-114">Let's jump in, and get the installation process started.</span></span>

## <a name="install-analyze-in-excel"></a><span data-ttu-id="51928-115">ติดตั้งการวิเคราะห์ใน Excel</span><span class="sxs-lookup"><span data-stu-id="51928-115">Install Analyze in Excel</span></span>

<span data-ttu-id="51928-116">คุณต้องติดตั้ง **วิเคราะห์ใน Excel** จากลิงก์ที่ให้ไว้ในบริการของ Power BI</span><span class="sxs-lookup"><span data-stu-id="51928-116">You must install **Analyze in Excel** from links provided in the Power BI service.</span></span> <span data-ttu-id="51928-117">Power BI ตรวจพบเวอร์ชันของ Excel ที่คุณมีในคอมพิวเตอร์ของคุณ และดาวน์โหลดเวอร์ชันที่เหมาะสม (32-bit หรือ 64-bit) โดยอัตโนมัติ</span><span class="sxs-lookup"><span data-stu-id="51928-117">Power BI detects the version of Excel you have on your computer, and automatically downloads the appropriate version (32-bit or 64-bit).</span></span> <span data-ttu-id="51928-118">บริการ Power BI ทำงานในเบราว์เซอร์</span><span class="sxs-lookup"><span data-stu-id="51928-118">The Power BI service runs in a browser.</span></span> <span data-ttu-id="51928-119">คุณสามารถลงชื่อเข้าใช้ Power BI โดยใช้ลิงก์ต่อไปนี้:</span><span class="sxs-lookup"><span data-stu-id="51928-119">You can sign in to the Power BI using the following link:</span></span>

* [<span data-ttu-id="51928-120">ลงชื่อเข้าใช้ Power BI</span><span class="sxs-lookup"><span data-stu-id="51928-120">Sign in to Power BI</span></span>](https://app.powerbi.com)

<span data-ttu-id="51928-121">หลังจากที่คุณลงชื่อเข้าใช้และบริการของ Power BI ทำงานอยู่ในเบราว์เซอร์ของคุณแล้ว ให้เลือกรายการ **ตัวเลือกเพิ่มเติม**  (...) ที่มุมบนขวาแล้วเลือก **ดาวน์โหลด > อัปเดตการวิเคราะห์ใน Excel**</span><span class="sxs-lookup"><span data-stu-id="51928-121">Once you've signed in and the Power BI service is running in your browser, select the **More options** item (the ...) in the upper-right corner and then select **Download > Analyze in Excel updates**.</span></span> <span data-ttu-id="51928-122">รายการเมนูนี้นำไปใช้กับการติดตั้งการอัปเดตของการวิเคราะห์ใน Excel ใหม่</span><span class="sxs-lookup"><span data-stu-id="51928-122">This menu item applies to new installations of updates of Analyze in Excel.</span></span>

![ดาวน์โหลดการวิเคราะห์ใน Excel จาก Power BI Home](media/service-analyze-in-excel/analyze-excel-02.png)

<span data-ttu-id="51928-124">อีกวิธีหนึ่งคือคุณสามารถนำทางในบริการของ Power BI ไปยังชุดข้อมูลที่คุณต้องการวิเคราะห์ และเลือกรายการ **ตัวเลือกเพิ่มเติม** สำหรับชุดข้อมูล รายงาน หรือรายการ Power BI อื่นๆ</span><span class="sxs-lookup"><span data-stu-id="51928-124">Alternatively, you can navigate in the Power BI service to a dataset you want to analyze, and select the **More options** item for a dataset, report, or other Power BI item.</span></span> <span data-ttu-id="51928-125">จากเมนูที่ปรากฏขึ้น เลือกตัวเลือก **วิเคราะห์ใน Excel** ดังที่แสดงในรูปต่อไปนี้</span><span class="sxs-lookup"><span data-stu-id="51928-125">From the menu that appears, select the **Analyze in Excel** option, as shown in the following image.</span></span>

![วิเคราะห์ใน Excel จากชุดข้อมูล](media/service-analyze-in-excel/analyze-excel-01.png)

<span data-ttu-id="51928-127">ไม่ว่าจะด้วยวิธีใด Power BI จะตรวจสอบว่าคุณมีการวิเคราะห์ใน Excel ติดตั้งอยู่หรือไม่ และหากไม่ คุณจะได้รับพร้อมท์เพื่อดาวน์โหลด</span><span class="sxs-lookup"><span data-stu-id="51928-127">Either way, Power BI detects whether you have Analyze in Excel installed, and if not, you're prompted to download.</span></span> 

![จำเป็นต้องมีการอัปเดต](media/service-analyze-in-excel/analyze-excel-03.png)

<span data-ttu-id="51928-129">เมื่อคุณเลือกดาวน์โหลด Power BI จะตรวจสอบเวอร์ชันของ Excel ที่คุณได้ติดตั้ง และดาวน์โหลดเวอร์ชันที่เหมาะสมของตัวติดตั้งการวิเคราะห์ใน Excel</span><span class="sxs-lookup"><span data-stu-id="51928-129">When you select download, Power BI detects the version of Excel you have installed and downloads the appropriate version of the Analyze in Excel installer.</span></span> <span data-ttu-id="51928-130">คุณจะเห็นสถานะการดาวน์โหลดที่ด้านล่างของเบราว์เซอร์ของคุณ หรือที่ใดก็ตามที่เบราว์เซอร์ของคุณแสดงความคืบหน้าการดาวน์โหลด</span><span class="sxs-lookup"><span data-stu-id="51928-130">You see a download status in the bottom of your browser, or wherever your browser displays download progress.</span></span> 

![กำลังดาวน์โหลดการอัปเดต](media/service-analyze-in-excel/analyze-excel-04.png)

<span data-ttu-id="51928-132">เมื่อการดาวน์โหลดเสร็จสมบูรณ์ ให้เรียกใช้ตัวติดตั้ง (.msi) เพื่อติดตั้งการวิเคราะห์ใน Excel</span><span class="sxs-lookup"><span data-stu-id="51928-132">When the download completes, run the installer (.msi) to install Analyze in Excel.</span></span> <span data-ttu-id="51928-133">ชื่อของกระบวนการติดตั้งแตกต่างจากการวิเคราะห์ใน Excel โดยชื่อจะเป็น **Microsoft Analysis Services OLE DB Provide** ดังที่แสดงในรูปต่อไปนี้ หรืออาจเป็นชื่ออื่นที่คล้ายกัน</span><span class="sxs-lookup"><span data-stu-id="51928-133">The name of the installation process is different from Analyze in Excel; the name will be **Microsoft Analysis Services OLE DB Provider** as shown in the following image, or something similar.</span></span>

![การอัปเดตการติดตั้งตัวให้บริการ Analysis Services OLE DB](media/service-analyze-in-excel/analyze-excel-05.png)

<span data-ttu-id="51928-135">เมื่อเสร็จสมบูรณ์แล้ว คุณก็พร้อมที่จะเลือกรายงานในบริการของ Power BI (หรือองค์ประกอบข้อมูล Power BI อื่นๆ เช่นชุดข้อมูล) จากนั้นทำการวิเคราะห์ใน Excel</span><span class="sxs-lookup"><span data-stu-id="51928-135">Once it completes, you're ready to select a report in the Power BI service (or other Power BI data element, like a dataset), and then analyze it in Excel.</span></span>

## <a name="connect-to-power-bi-data"></a><span data-ttu-id="51928-136">เชื่อมต่อกับข้อมูล Power BI</span><span class="sxs-lookup"><span data-stu-id="51928-136">Connect to Power BI data</span></span>

<span data-ttu-id="51928-137">ในบริการของ Power BI ให้ไปที่ชุดข้อมูลหรือรายงานที่คุณต้องการวิเคราะห์ใน Excel จากนั้นให้ดำเนินการต่อไปนี้:</span><span class="sxs-lookup"><span data-stu-id="51928-137">In the Power BI service, navigate to the dataset or report you want to analyze in Excel, and then:</span></span>

1. <span data-ttu-id="51928-138">เลือกเมนู **ตัวเลือกเพิ่มเติม**</span><span class="sxs-lookup"><span data-stu-id="51928-138">Select the **More options** menu.</span></span>

1. <span data-ttu-id="51928-139">เลือก **วิเคราะห์ใน Excel** จากรายการเมนูที่ปรากฏขึ้น</span><span class="sxs-lookup"><span data-stu-id="51928-139">Select **Analyze in Excel** from the menu items that appear.</span></span>

    <span data-ttu-id="51928-140">รูปภาพต่อไปนี้แสดงการเลือกรายงาน</span><span class="sxs-lookup"><span data-stu-id="51928-140">The following image shows selecting a report.</span></span>

    ![กำลังติดตั้งการอัปเดต](media/service-analyze-in-excel/analyze-excel-06.png)
    
    >[!NOTE]
    ><span data-ttu-id="51928-142">โปรดทราบว่าหากคุณเลือกวิเคราะห์ใน Excel จากเมนูรายงาน ระบบจะใส่ชุดข้อมูลพื้นฐานของรายงานลงใน Excel</span><span class="sxs-lookup"><span data-stu-id="51928-142">Remember that if you select Analyze in Excel from a Report menu, it is the report's underlying dataset that is brought into Excel.</span></span>

    <span data-ttu-id="51928-143">จากนั้นบริการของ Power BI จะสร้างไฟล์ Excel ของชุดข้อมูลซึ่งออกแบบ (และจัดโครงสร้าง) เพื่อใช้กับ **วิเคราะห์ใน Excel** และเริ่มต้นกระบวนการดาวน์โหลดในเบราว์เซอร์ของคุณ</span><span class="sxs-lookup"><span data-stu-id="51928-143">The Power BI service then creates an Excel file of the dataset that's designed (and structured) for use with **Analyze in Excel**, and begins a download process in your browser.</span></span>
    
    ![การดาวน์โหลดไฟล์ Excel](media/service-analyze-in-excel/analyze-in-excel-download-xlsx.png)

    <span data-ttu-id="51928-145">ชื่อไฟล์ตรงกับชุดข้อมูล (หรือรายงาน หรือแหล่งข้อมูลอื่นๆ) จากที่ได้รับมา</span><span class="sxs-lookup"><span data-stu-id="51928-145">The file name matches the dataset (or report, or other data source) from which it was derived.</span></span> <span data-ttu-id="51928-146">ดังนั้น หากรายงานมีชื่อว่า *รายงานรายไตรมาส* ไฟล์ที่ดาวน์โหลดก็จะมีชื่อเป็น **รายงานรายไตรมาส.xlsx**</span><span class="sxs-lookup"><span data-stu-id="51928-146">So if the report was called *Quarterly Report*, then the downloaded file would be **Quarterly Report.xlsx**.</span></span>

    >[!Note]
    ><span data-ttu-id="51928-147">วิเคราะห์ใน Excel ตอนนี้ดาวน์โหลดไฟล์ Excel แทนที่จะเป็นไฟล์ ODC</span><span class="sxs-lookup"><span data-stu-id="51928-147">Analyze in Excel now downloads an Excel file instead of an ODC file.</span></span> <span data-ttu-id="51928-148">ซึ่งเป็นการเปิดใช้งานการป้องกันข้อมูลบนข้อมูลที่ส่งออกจาก Power BI</span><span class="sxs-lookup"><span data-stu-id="51928-148">This enables data protection on data exported from Power BI.</span></span> <span data-ttu-id="51928-149">ไฟล์ Excel ที่ดาวน์โหลดมาจะสืบทอดป้ายชื่อระดับความลับของชุดข้อมูลที่เลือกสำหรับการวิเคราะห์ใน Excel</span><span class="sxs-lookup"><span data-stu-id="51928-149">The downloaded Excel file inherits the sensitivity label of the dataset chosen for Analyze in Excel.</span></span>

3. <span data-ttu-id="51928-150">เริ่มใช้งานไฟล์ Excel</span><span class="sxs-lookup"><span data-stu-id="51928-150">Launch the Excel file.</span></span>

    >[!NOTE]
    ><span data-ttu-id="51928-151">เมื่อคุณเปิดไฟล์ครั้งแรก คุณอาจต้อง **เปิดใช้งานการแก้ไข** จากนั้น **เปิดใช้งานเนื้อหา** ทั้งนี้ขึ้นอยู่กับการตั้งค่า [มุมมองที่มีการป้องกัน](https://support.microsoft.com/en-gb/office/what-is-protected-view-d6f09ac7-e6b9-4495-8e43-2bbcdbcb6653?ui=en-us&rs=en-gb&ad=gb)และ [เอกสารที่น่าเชื่อถือ](https://support.microsoft.com/en-us/office/trusted-documents-cf872bd8-47ec-4c02-baa5-1fdba1a11b53)ของคุณ</span><span class="sxs-lookup"><span data-stu-id="51928-151">The first time you open the file, you may have to **Enable Editing** and then **Enable Content**, depending on your [Protected view](https://support.microsoft.com/en-gb/office/what-is-protected-view-d6f09ac7-e6b9-4495-8e43-2bbcdbcb6653?ui=en-us&rs=en-gb&ad=gb) and [Trusted document](https://support.microsoft.com/en-us/office/trusted-documents-cf872bd8-47ec-4c02-baa5-1fdba1a11b53) settings.</span></span>
    >
    >![ภาพหน้าจอของแบนเนอร์เปิดใช้งานการตั้งค่าสำหรับมุมมองที่มีการป้องกัน](media/service-analyze-in-excel/protected-view-enable-editing-banner.png)
    >
    >![ภาพหน้าจอของแบนเนอร์เปิดใช้งานเนื้อหาสำหรับเอกสารที่น่าเชื่อถือ](media/service-analyze-in-excel/trusted-document-enable-content-banner.png)

<span data-ttu-id="51928-154">เมื่อใช้ Excel ในการวิเคราะห์ Power BI โดยใช้ PivotTable จะช่วยให้ Power BI ส่งต่อค่าของป้ายระดับความลับไปยัง Excel</span><span class="sxs-lookup"><span data-stu-id="51928-154">When using Excel to analyze Power BI using a PivotTable, Power BI extends sensitivity label inheritance to Excel.</span></span> <span data-ttu-id="51928-155">ป้ายบอกระดับความลับที่ใช้ในชุดข้อมูล Power BI จะถูกนำไปใช้กับไฟล์ Excel โดยอัตโนมัติเมื่อคุณสร้าง PivotTable ใน Excel</span><span class="sxs-lookup"><span data-stu-id="51928-155">A sensitivity label applied on a Power BI dataset is automatically applied to the Excel file when you create a PivotTable in Excel.</span></span> 

<span data-ttu-id="51928-156">ถ้าในเวลาต่อมาป้ายชื่อบนชุดข้อมูลมีการเปลี่ยนแปลงให้มีความรัดกุมมากขึ้น ป้ายชื่อที่ใช้ในไฟล์ Excel จะอัปเดตโดยอัตโนมัติเมื่อรีเฟรชข้อมูลใน Excel</span><span class="sxs-lookup"><span data-stu-id="51928-156">If the label on the dataset subsequently changes to be more restrictive, the label applied to the Excel file is automatically updated upon data refresh in Excel.</span></span> <span data-ttu-id="51928-157">ถ้าชุดข้อมูลได้รับการเปลี่ยนแปลงให้มีความรัดกุมน้อยลง จะไม่มีการส่งต่อป้ายชื่อหรือการอัปเดต</span><span class="sxs-lookup"><span data-stu-id="51928-157">If the dataset changes to become less restrictive, no label inheritance or update occurs.</span></span>

<span data-ttu-id="51928-158">ป้ายระดับความลับใน Excel ที่ตั้งไว้ด้วยตนเองจะไม่ถูกเขียนทับโดยป้ายระดับความลับของชุดข้อมูลโดยอัตโนมัติ</span><span class="sxs-lookup"><span data-stu-id="51928-158">Sensitivity labels in Excel that were manually set are not automatically overwritten by the dataset's label.</span></span> <span data-ttu-id="51928-159">ถ้าไฟล์ Excel มีป้ายระดับความลับที่ตั้งด้วยตัวเอง จะมีเคล็ดลับนโยบายปรากฏขึ้น โดยจะมีคำแนะนำให้อัปเกรดป้าย</span><span class="sxs-lookup"><span data-stu-id="51928-159">If an Excel file has a manually set sensitivity label, a policy tip will appear with a recommendation to upgrade the label.</span></span> 

<span data-ttu-id="51928-160">สำหรับข้อมูลเพิ่มเติม โปรดดู [วิธีการปรับใช้ป้ายบอกระดับความลับใน Power BI](../admin/service-security-apply-data-sensitivity-labels.md)</span><span class="sxs-lookup"><span data-stu-id="51928-160">For more information, see [how to apply sensitivity labels in Power BI](../admin/service-security-apply-data-sensitivity-labels.md).</span></span>


## <a name="use-excel-to-analyze-the-data"></a><span data-ttu-id="51928-161">ใช้ Excel ในการวิเคราะห์ข้อมูล</span><span class="sxs-lookup"><span data-stu-id="51928-161">Use Excel to analyze the data</span></span>

<span data-ttu-id="51928-162">เมื่อคุณเปิดใช้งานการแก้ไขและเนื้อหาแล้ว Excel จะแสดงให้คุณเห็นรายการ **PivotTable** และ **เขตข้อมูล** ที่ว่างเปล่าจากชุดข้อมูล Power BI ซึ่งพร้อมที่จะวิเคราะห์</span><span class="sxs-lookup"><span data-stu-id="51928-162">Once you've enabled editing and content, Excel presents you with an empty **PivotTable** and **Fields** list from the Power BI dataset, ready to be analyzed.</span></span>

![Excel ที่มีการเชื่อมต่อข้อมูล](media/service-analyze-in-excel/analyze-in-excel-connected.png)

<span data-ttu-id="51928-164">ไฟล์ Excel มีสตริงการเชื่อมต่อ MSOLAP ที่เชื่อมต่อกับชุดข้อมูลของคุณใน Power BI</span><span class="sxs-lookup"><span data-stu-id="51928-164">The Excel file has an MSOLAP connection string that connects to your dataset in Power BI.</span></span> <span data-ttu-id="51928-165">เมื่อคุณวิเคราะห์หรือทำงานกับข้อมูลดังกล่าว Excel ร้องขอชุดข้อมูลใน Power BI และส่งกลับผลลัพธ์ไปยัง Excel</span><span class="sxs-lookup"><span data-stu-id="51928-165">When you analyze or work with the data, Excel queries that dataset in Power BI and returns the results to Excel.</span></span> <span data-ttu-id="51928-166">ถ้าชุดข้อมูลนั้นเชื่อมต่อกับแหล่งข้อมูลสดโดยใช้ DirectQuery, Power BI ร้องขอแหล่งข้อมูลและส่งผลลัพธ์ไปยัง Excel</span><span class="sxs-lookup"><span data-stu-id="51928-166">If that dataset connects to a live data source using DirectQuery, Power BI queries the data source and returns the result to Excel.</span></span>

<span data-ttu-id="51928-167">ด้วยการเชื่อมต่อกับข้อมูลใน Power BI นั้น คุณสามารถสร้าง Pivottable แผนภูมิ และวิเคราะห์ชุดข้อมูลในทำนองเดียวกับที่คุณจะดำเนินการกับชุดข้อมูลภายในเครื่องใน Excel</span><span class="sxs-lookup"><span data-stu-id="51928-167">With that connection to the data in Power BI now established, you can create PivotTables, charts, and analyze that dataset just as you would work with a local dataset in Excel.</span></span>

<span data-ttu-id="51928-168">**วิเคราะห์ใน Excel** มีประโยชน์โดยเฉพาะอย่างยิ่งสำหรับชุดข้อมูลและรายงานที่เชื่อมต่อกับแหล่งข้อมูลดังต่อไปนี้:</span><span class="sxs-lookup"><span data-stu-id="51928-168">**Analyze in Excel** is especially useful for datasets and reports that connect to the following data sources:</span></span>

* <span data-ttu-id="51928-169">ฐานข้อมูล *แบบตารางบริการการวิเคราะห์* หรือ *แบบหลายมิติ*</span><span class="sxs-lookup"><span data-stu-id="51928-169">*Analysis Services Tabular* or *Multidimensional* databases</span></span>
* <span data-ttu-id="51928-170">ไฟล์หรือสมุดงาน Excel ใน Power BI Desktop  ที่มีแบบจำลองข้อมูลซึ่งมีหน่วยวัดแบบจำลองที่สร้างขึ้นโดยใช้นิพจน์การวิเคราะห์ข้อมูล (DAX)</span><span class="sxs-lookup"><span data-stu-id="51928-170">Power BI Desktop files or Excel workbooks with data models that have model measures created using Data Analysis Expressions (DAX).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="51928-171">การใช้ **วิเคราะห์ใน Excel** จะแสดงข้อมูลในระดับรายละเอียดทั้งหมดให้กับผู้ใช้ทุกคนที่มีสิทธิ์ในการเข้าถึงชุดข้อมูล</span><span class="sxs-lookup"><span data-stu-id="51928-171">Using **Analyze in Excel** exposes all detail-level data to any users with permission to the dataset.</span></span>

<span data-ttu-id="51928-172">มีหลายสิ่งที่ต้องพิจารณาเมื่อคุณเริ่มใช้การวิเคราะห์ใน Excel ซึ่งอาจต้องมีขั้นตอนเพิ่มเติมหนึ่งหรือสองขั้นตอนในการจัดการ</span><span class="sxs-lookup"><span data-stu-id="51928-172">There are a handful of things to consider when you begin using Analyze in Excel, which might require an extra step or two to reconcile.</span></span> <span data-ttu-id="51928-173">ความเป็นไปได้เหล่านี้จะอธิบายไว้ในส่วนต่อไปนี้</span><span class="sxs-lookup"><span data-stu-id="51928-173">These possibilities are described in the following sections.</span></span> 


### <a name="sign-in-to-power-bi"></a><span data-ttu-id="51928-174">ลงชื่อเข้าใช้ไปยัง Power BI</span><span class="sxs-lookup"><span data-stu-id="51928-174">Sign in to Power BI</span></span>
<span data-ttu-id="51928-175">แม้ว่าคุณลงชื่อเข้าใช้ Power BI แล้วในเบราว์เซอร์ของคุณ ครั้งแรกที่คุณเปิดไฟล์ Excel ใหม่ใน Excel คุณอาจถูกขอให้ลงชื่อเข้าใช้ Power BI ด้วยบัญชี Power BI ของคุณ</span><span class="sxs-lookup"><span data-stu-id="51928-175">Although you’re signed in to Power BI in your browser, the first time you open a new Excel file in Excel you may be asked to sign in to Power BI with your Power BI account.</span></span> <span data-ttu-id="51928-176">ซึ่งขั้นตอนนี้รับรองความถูกต้องการเชื่อมต่อจาก Excel ไปยัง Power BI</span><span class="sxs-lookup"><span data-stu-id="51928-176">This authenticates the connection from Excel to Power BI.</span></span>

### <a name="users-with-multiple-power-bi-accounts"></a><span data-ttu-id="51928-177">ผู้ใช้ที่มีบัญชี Power BI หลายบัญชี</span><span class="sxs-lookup"><span data-stu-id="51928-177">Users with multiple Power BI accounts</span></span>
<span data-ttu-id="51928-178">ผู้ใช้บางรายมีบัญชี Power BI หลายบัญชี</span><span class="sxs-lookup"><span data-stu-id="51928-178">Some users have multiple Power BI accounts.</span></span> <span data-ttu-id="51928-179">หากคุณเป็นคนหนึ่ง คุณอาจลงชื่อเข้าใช้ Power BI ด้วยบัญชีเดียว แต่บัญชีอื่นๆ ของคุณมีการเข้าถึงชุดข้อมูลที่ใช้ในการวิเคราะห์ใน Excel</span><span class="sxs-lookup"><span data-stu-id="51928-179">If that's you, you might be signed in to Power BI with one account, but your other account has access to the dataset being used in Analyze in Excel.</span></span> <span data-ttu-id="51928-180">ในกรณีนั้น คุณอาจได้รับการแจ้งข้อผิดพลาด **ห้ามใช้งาน** หรือเข้าสู่ระบบไม่สำเร็จขณะพยายามเข้าถึงชุดข้อมูลที่กำลังใช้ในเวิร์กบุ๊กการวิเคราะห์ใน Excel</span><span class="sxs-lookup"><span data-stu-id="51928-180">In that case, you might see a **Forbidden** error, or a sign-in failure when attempting to access a dataset that's being used in an Analyze in Excel workbook.</span></span>

<span data-ttu-id="51928-181">หากเกิดขึ้นเช่นนั้น คุณจะมีโอกาสในการลงชื่อเข้าใช้ในอีกครั้งหนึ่ง ซึ่งคุณสามารถลงชื่อเข้าใช้ด้วยบัญชี Power BI ที่มีสิทธิ์เข้าถึงชุดข้อมูลที่กำลังเข้าถึงโดยการวิเคราะห์ใน Excel ได้</span><span class="sxs-lookup"><span data-stu-id="51928-181">If that happens, you'll be provided an opportunity to sign in again, at which time you can sign in with the Power BI account that has access to the dataset being accessed by Analyze in Excel.</span></span> <span data-ttu-id="51928-182">คุณยังสามารถเลือกชื่อของคุณในแถบเครื่องมือด้านบนสุดใน Excel ซึ่งระบุบัญชีที่คุณกำลังลงชื่อเข้าใช้ด้วยในปัจจุบัน</span><span class="sxs-lookup"><span data-stu-id="51928-182">You can also select your name in the top ribbon in Excel, which identifies which account is currently signed in.</span></span> <span data-ttu-id="51928-183">ลงชื่อออกจากระบบและลงชื่อเข้าใช้อีกครั้งด้วยบัญชีอื่น</span><span class="sxs-lookup"><span data-stu-id="51928-183">Sign out and sign back in with the other account.</span></span>


## <a name="saving-and-sharing-your-new-workbook"></a><span data-ttu-id="51928-184">การบันทึกและการแชร์เวิร์กบุ๊กใหม่ของคุณ</span><span class="sxs-lookup"><span data-stu-id="51928-184">Saving and sharing your new workbook</span></span>

<span data-ttu-id="51928-185">คุณสามารถ **บันทึก** เวิร์กบุ๊ก Excel ที่คุณสร้างขึ้นด้วยชุดข้อมูล Power BI ได้เช่นเดียวกับเวิร์กบุ๊กอื่น</span><span class="sxs-lookup"><span data-stu-id="51928-185">You can **Save** the Excel workbook you create with the Power BI dataset, just like any other workbook.</span></span> <span data-ttu-id="51928-186">อย่างไรก็ตาม คุณไม่สามารถเผยแพร่ หรือนำเข้าเวิร์กบุ๊กกลับไปยัง Power BI ได้ เนื่องจากคุณสามารถเผยแพร่หรือนำเข้าสมุดงานไปยัง Power BI ที่มีข้อมูลในตาราง หรือที่มีแบบจำลองข้อมูลได้เท่านั้น</span><span class="sxs-lookup"><span data-stu-id="51928-186">However, you cannot publish or import the workbook back into Power BI, because you can only publish or import workbooks into Power BI that have data in tables, or that have a data model.</span></span> <span data-ttu-id="51928-187">เนื่องจากสมุดงานใหม่มีการเชื่อมต่อกับชุดข้อมูลใน Power BI การเผยแพร่หรือนำเข้าไปยัง Power BI จะวนกลับไปกลับมา!</span><span class="sxs-lookup"><span data-stu-id="51928-187">Since the new workbook simply has a connection to the dataset in Power BI, publishing or importing it into Power BI would be going in circles!</span></span>

<span data-ttu-id="51928-188">เมื่อบันทึกสมุดงานของคุณแล้ว คุณสามารถแชร์กับผู้ใช้ Power BI อื่นในองค์กรของคุณได้</span><span class="sxs-lookup"><span data-stu-id="51928-188">Once your workbook is saved, you can share it with other Power BI users in your organization.</span></span> 

<span data-ttu-id="51928-189">เมื่อผู้ใช้ที่คุณแชร์เวิร์กบุ๊กของคุณด้วยเปิดเวิร์กบุ๊กนั้นขึ้น พวกเขาจะเห็น Pivottable และข้อมูลของคุณตามที่ปรากฏเมื่อคุณบันทึกเวิร์กบุ๊กของคุณครั้งสุดท้าย ซึ่งอาจไม่ใช่ข้อมูลเวอร์ชันล่าสุด</span><span class="sxs-lookup"><span data-stu-id="51928-189">When a user with whom you’ve shared your workbook opens it, they’ll see your PivotTables and data as they appeared when the workbook was last saved, which may not be the latest version of the data.</span></span> <span data-ttu-id="51928-190">เพื่อให้ได้ข้อมูลล่าสุด ผู้ใช้ต้องใช้ปุ่ม **รีเฟรช** บน Ribbon **ข้อมูล**</span><span class="sxs-lookup"><span data-stu-id="51928-190">To get the latest data, users must use the **Refresh** button on the **Data** ribbon.</span></span> <span data-ttu-id="51928-191">และเนื่องจากเวิร์กบุ๊กกำลังเชื่อมต่อไปยังชุดข้อมูลใน Power BI ผู้ใช้ที่พยายามรีเฟรชเวิร์กบุ๊กต้องลงชื่อเข้าใช้ใน Power BI และติดตั้งการอัปเดต Excel ครั้งแรกที่พวกเขาพยายามที่จะอัปเดตโดยใช้วิธีการนี้</span><span class="sxs-lookup"><span data-stu-id="51928-191">And since the workbook is connecting to a dataset in Power BI, users attempting to refresh the workbook must sign in to Power BI and install the Excel updates the first time they attempt to update using this method.</span></span>

<span data-ttu-id="51928-192">เนื่องจากผู้ใช้ต้องรีเฟรชชุดข้อมูลนั้น และการรีเฟรชสำหรับการเชื่อมต่อภายนอกไม่รองรับอยู่ใน Excel Online ขอแนะนำให้ผู้ใช้เปิดเวิร์กบุ๊กใน Excel เวอร์ชันเดสก์ท็อปบนคอมพิวเตอร์ของผู้ใช้งาน</span><span class="sxs-lookup"><span data-stu-id="51928-192">Since users need to refresh the dataset, and refresh for external connections is not supported in Excel Online, it’s recommended that users open the workbook in the desktop version of Excel on their computer.</span></span>

> [!NOTE]
> <span data-ttu-id="51928-193">ผู้ดูแลระบบสำหรับผู้เช่า Power BI สามารถใช้ *พอร์ทัลผู้ดูแลระบบของ Power BI* เพื่อปิดใช้งาน **วิเคราะห์ใน Excel** ที่มีชุดข้อมูลภายในองค์กรที่ถูกติดตั้งในฐานข้อมูล Analysis Services (AS) ได้</span><span class="sxs-lookup"><span data-stu-id="51928-193">Administrators for Power BI tenants can use the *Power BI Admin Portal* to disable the use of **Analyze in Excel** with on-premises datasets housed in Analysis Services (AS) databases.</span></span> <span data-ttu-id="51928-194">เมื่อตัวเลือกนั้นถูกปิดใช้งาน **วิเคราะห์ใน Excel** ถูกปิดใช้งานสำหรับฐานข้อมูล AS แต่ยังคงพร้อมใช้งานสำหรับการใช้กับชุดข้อมูลอื่น</span><span class="sxs-lookup"><span data-stu-id="51928-194">When that option is disabled, **Analyze in Excel** is disabled for AS databases, but continues to be available for use with other datasets.</span></span>


## <a name="other-ways-to-access-power-bi-datasets-from-excel"></a><span data-ttu-id="51928-195">วิธีอื่นในการเข้าถึงชุดข้อมูล Power BI จาก Excel</span><span class="sxs-lookup"><span data-stu-id="51928-195">Other ways to access Power BI datasets from Excel</span></span>
<span data-ttu-id="51928-196">ผู้ใช้ที่มี Office SKU เฉพาะยังสามารถเชื่อมต่อกับชุดข้อมูล Power BI จากภายใน Excel ได้โดยใช้คุณลักษณะ **รับข้อมูล** ใน Excel</span><span class="sxs-lookup"><span data-stu-id="51928-196">Users with specific Office SKUs can also connect to Power BI datasets from within Excel by using the **Get Data** feature in Excel.</span></span> <span data-ttu-id="51928-197">ถ้า SKU ของคุณไม่รองรับคุณลักษณะนี้ ตัวเลือกเมนู **รับข้อมูล** จะไม่ปรากฏขึ้น</span><span class="sxs-lookup"><span data-stu-id="51928-197">If your SKU does not support this feature, the **Get Data** menu option does not appear.</span></span>

<span data-ttu-id="51928-198">จากเมนูแถบเครื่องมือ **ข้อมูล** เลือก  **รับข้อมูล > จากชุดข้อมูล Power BI** ดังที่แสดงในรูปต่อไปนี้</span><span class="sxs-lookup"><span data-stu-id="51928-198">From the **Data** ribbon menu, select **Get Data > From Power BI dataset** as shown in the following image.</span></span>

![การใช้เมนูรับข้อมูล](media/service-analyze-in-excel/analyze-excel-10.png)

<span data-ttu-id="51928-200">บานหน้าต่างจะปรากฏขึ้นซึ่งคุณสามารถเรียกดูชุดข้อมูลที่คุณมีสิทธิ์เข้าถึง และดูว่าชุดข้อมูลได้รับการรับรองหรือได้รับการเลื่อนระดับหรือไม่ อีกทั้งพิจารณาว่ามีการใช้ป้ายชื่อการป้องกันข้อมูลกับชุดข้อมูลเหล่านั้นหรือไม่</span><span class="sxs-lookup"><span data-stu-id="51928-200">A pane appears, in which you can browse datasets to which you have access, see if datasets are certified or promoted, and determine whether data protection labels have been applied to those datasets.</span></span> 

<span data-ttu-id="51928-201">สำหรับข้อมูลเพิ่มเติมเกี่ยวกับการรับข้อมูลลงใน Excel ด้วยวิธีนี้ ดู [สร้าง PivotTable จากชุดข้อมูล Power BI](https://support.office.com/article/31444a04-9c38-4dd7-9a45-22848c666884) ในเอกสารประกอบของ Excel</span><span class="sxs-lookup"><span data-stu-id="51928-201">For more information about getting data into Excel in this way, see [Create a PivotTable from Power BI datasets](https://support.office.com/article/31444a04-9c38-4dd7-9a45-22848c666884) in the Excel documentation.</span></span>

<span data-ttu-id="51928-202">คุณยังสามารถเข้าถึง **ตารางที่แนะนำ** ใน Excel ได้ ในแกลเลอรี **ชนิดข้อมูล**</span><span class="sxs-lookup"><span data-stu-id="51928-202">You can also access **featured tables** in Excel, in the **Data Types** gallery.</span></span> <span data-ttu-id="51928-203">หากต้องการเรียนรู้เพิ่มเติมเกี่ยวกับตารางที่แนะนำและวิธีการเข้าถึงตารางเหล่านั้น ดู [เข้าถึงตารางที่แนะนำ Power BI ใน Excel (ตัวอย่าง)](service-excel-featured-tables.md)</span><span class="sxs-lookup"><span data-stu-id="51928-203">To learn more about featured tables, and how to access them, see [Access Power BI featured tables in Excel (preview)](service-excel-featured-tables.md).</span></span>

## <a name="requirements"></a><span data-ttu-id="51928-204">ข้อกำหนด</span><span class="sxs-lookup"><span data-stu-id="51928-204">Requirements</span></span>
<span data-ttu-id="51928-205">มีสองสามข้อกำหนดสำหรับการใช้ **วิเคราะห์ใน Excel**:</span><span class="sxs-lookup"><span data-stu-id="51928-205">There are a few requirements for using **Analyze in Excel**:</span></span>

* <span data-ttu-id="51928-206">**วิเคราะห์ใน Excel** สนับสนุนสำหรับ Microsoft Excel 2010 SP1 และเวอร์ชั่นที่ใหม่กว่า</span><span class="sxs-lookup"><span data-stu-id="51928-206">**Analyze in Excel** is supported for Microsoft Excel 2010 SP1 and later.</span></span>

* <span data-ttu-id="51928-207">Pivottable ของ Excel ไม่สนับสนุนการรวมที่ลากแล้วปล่อยสำหรับเขตข้อมูลตัวเลข</span><span class="sxs-lookup"><span data-stu-id="51928-207">Excel PivotTables do not support drag-and-drop aggregation of numeric fields.</span></span> <span data-ttu-id="51928-208">ชุดข้อมูลของคุณใน Power BI *ต้องมีหน่วยวัดที่กำหนดไว้ล่วงหน้า*</span><span class="sxs-lookup"><span data-stu-id="51928-208">Your dataset in Power BI *must have pre-defined measures*.</span></span> <span data-ttu-id="51928-209">อ่านเกี่ยวกับ [การสร้างหน่วยวัด](../transform-model/desktop-measures.md)</span><span class="sxs-lookup"><span data-stu-id="51928-209">Read about [creating measures](../transform-model/desktop-measures.md).</span></span>
* <span data-ttu-id="51928-210">บางองค์กรอาจมี Group Policy (นโยบายของทั้งองค์กร) ที่ป้องกันการติดตั้งอัปเดต **วิเคราะห์ใน Excel** ที่จำเป็นไปยัง Excel</span><span class="sxs-lookup"><span data-stu-id="51928-210">Some organizations may have Group Policy rules that prevent installing the required **Analyze in Excel** updates to Excel.</span></span> <span data-ttu-id="51928-211">ถ้าคุณไม่สามารถติดตั้งการอัปเดตได้ โปรดตรวจสอบกับผู้ดูแลระบบของคุณ</span><span class="sxs-lookup"><span data-stu-id="51928-211">If you’re unable to install the updates, check with your administrator.</span></span>
* <span data-ttu-id="51928-212">**วิเคราะห์ใน Excel** ต้องการให้ชุดข้อมูลใน Power BI Premium หรือที่ว่าผู้ใช้มีใบอนุญาต Power BI Pro</span><span class="sxs-lookup"><span data-stu-id="51928-212">**Analyze in Excel** requires that the dataset be in Power BI Premium or that the user have a Power BI Pro license.</span></span> <span data-ttu-id="51928-213">เมื่อต้องการเรียนรู้เพิ่มเติมเกี่ยวกับความแตกต่างในฟังก์ชันการทำงานระหว่างสิทธิ์ในการใช้ Power BI แบบต่างๆ ดูที่ _การเปรียบเทียบคุณลักษณะ Power BI_[ตามราคา](https://powerbi.microsoft.com/pricing/)</span><span class="sxs-lookup"><span data-stu-id="51928-213">To learn more about the differences in functionality between license types, take a look at the _Power BI features comparison_ section of [Power BI pricing](https://powerbi.microsoft.com/pricing/).</span></span>
* <span data-ttu-id="51928-214">ผู้ใช้สามารถเชื่อมต่อกับชุดข้อมูลผ่าน Analyze ใน Excel หากพวกเขามีสิทธิสำหรับชุดข้อมูลพื้นฐาน</span><span class="sxs-lookup"><span data-stu-id="51928-214">Users can connect to datasets through Analyze in Excel if they have permission for the underlying dataset.</span></span>  <span data-ttu-id="51928-215">ผู้ใช้สามารถมีสิทธินี้ได้หลายแนวทาง เช่น การมีบทบาทสมาชิกในพื้นที่ทำงานที่มีชุดข้อมูล มีรายงานหรือแดชบอร์ดที่แชร์กับพวกเขาที่ใช้ชุดข้อมูลดังกล่าว หรือมีสิทธิในการสร้างสำหรับชุดข้อมูลในพื้นที่ทำงานหรือแอปที่มีชุดข้อมูล</span><span class="sxs-lookup"><span data-stu-id="51928-215">A user could have this permission in several ways, such as having the Member role in the workspace containing the dataset, having a report or dashboard shared to them that uses the dataset, or having Build permission for the dataset, in either a workspace or an app that contains the dataset.</span></span> <span data-ttu-id="51928-216">อ่านเพิ่มเติมเกี่ยวกับ[สิทธิในการสร้าง](../connect-data/service-datasets-build-permissions.md)สำหรับชุดข้อมูล</span><span class="sxs-lookup"><span data-stu-id="51928-216">Read more about [Build permission](../connect-data/service-datasets-build-permissions.md) for datasets.</span></span>
* <span data-ttu-id="51928-217">ผู้ใช้ที่เป็นผู้เยี่ยมชมไม่สามารถใช้ **วิเคราะห์ใน Excel** สำหรับชุดข้อมูลที่ส่งจาก (มีที่มาจาก) ผู้เช่ารายอื่น</span><span class="sxs-lookup"><span data-stu-id="51928-217">Guest users cannot use **Analyze in Excel** for datasets sent from (originating from) another tenant.</span></span> 
* <span data-ttu-id="51928-218">**Analyze ใน Excel** เป็นคุณลักษณะบริการของ Power BI และไม่พร้อมใช้งานในเซิร์ฟเวอร์รายงาน Power BI หรือ Power BI Embedded</span><span class="sxs-lookup"><span data-stu-id="51928-218">**Analyze in Excel** is a Power BI service feature, and is not available in Power BI Report Server or Power BI Embedded.</span></span> 
* <span data-ttu-id="51928-219">**Analyze ใน Excel** รองรับเฉพาะในคอมพิวเตอร์ที่ติดตั้ง Microsoft Windows</span><span class="sxs-lookup"><span data-stu-id="51928-219">**Analyze in Excel** is only supported on computers running Microsoft Windows.</span></span>


<span data-ttu-id="51928-220">สำหรับผู้ใช้ที่ต้องการถอนการติดตั้งคุณลักษณะ **วิเคราะห์ใน Excel** คุณสามารถทำได้โดยใช้การตั้งค่าระบบ **เพิ่มหรือลบโปรแกรม** ในคอมพิวเตอร์ Windows ของคุณ</span><span class="sxs-lookup"><span data-stu-id="51928-220">For users who need to uninstall the **Analyze in Excel** feature, you can do so using the **Add or remove programs** system setting on your Windows computer.</span></span>

## <a name="troubleshooting"></a><span data-ttu-id="51928-221">การแก้ไขปัญหา</span><span class="sxs-lookup"><span data-stu-id="51928-221">Troubleshooting</span></span>
<span data-ttu-id="51928-222">อาจมีบางครั้งที่เมื่อคุณใช้การวิเคราะห์ใน Excel คุณได้รับผลลัพธ์ที่ไม่คาดคิดหรือลักษณะการทำงานไม่ทำงานตามที่คุณคาดไว้</span><span class="sxs-lookup"><span data-stu-id="51928-222">There may be times when using Analyze in Excel that you get an unexpected result, or the feature doesn't work as you expected.</span></span> <span data-ttu-id="51928-223">[หน้านี้เสนอโซลูชันสำหรับปัญหาทั่วไปเมื่อใช้การวิเคราะห์ใน Excel](desktop-troubleshooting-analyze-in-excel.md)</span><span class="sxs-lookup"><span data-stu-id="51928-223">[This page provides solutions for common issues when using Analyze in Excel](desktop-troubleshooting-analyze-in-excel.md).</span></span>

## <a name="next-steps"></a><span data-ttu-id="51928-224">ขั้นตอนถัดไป</span><span class="sxs-lookup"><span data-stu-id="51928-224">Next steps</span></span>

<span data-ttu-id="51928-225">คุณอาจสนใจบทความต่อไปนี้:</span><span class="sxs-lookup"><span data-stu-id="51928-225">You might also be interested in the following articles:</span></span>

* [<span data-ttu-id="51928-226">ใช้ตัวเจาะเข้าถึงรายละเอียดข้ามรายงานใน Power BI Desktop</span><span class="sxs-lookup"><span data-stu-id="51928-226">Use cross-report drillthrough in Power BI Desktop</span></span>](../create-reports/desktop-cross-report-drill-through.md)
* [<span data-ttu-id="51928-227">การใช้ตัวแบ่งส่วนข้อมูล Power BI Desktop</span><span class="sxs-lookup"><span data-stu-id="51928-227">Using slicers Power BI Desktop</span></span>](../visuals/power-bi-visualization-slicers.md)
* [<span data-ttu-id="51928-228">การแก้ไขปัญหาการวิเคราะห์ใน Excel</span><span class="sxs-lookup"><span data-stu-id="51928-228">Troubleshooting Analyze in Excel</span></span>](desktop-troubleshooting-analyze-in-excel.md)
* <span data-ttu-id="51928-229">[เข้าถึงตารางที่แนะนำของ Power BI ใน Excel (ตัวอย่าง)](service-excel-featured-tables.md)</span><span class="sxs-lookup"><span data-stu-id="51928-229">[Access Power BI featured tables in Excel (preview)](service-excel-featured-tables.md).</span></span>
* [<span data-ttu-id="51928-230">วิธีการใช้ป้ายชื่อระดับความลับใน Power BI</span><span class="sxs-lookup"><span data-stu-id="51928-230">How to apply sensitivity labels in Power BI</span></span>](../admin/service-security-apply-data-sensitivity-labels.md)
