---
title: สถานการณ์ความจุของ Microsoft Power BI Premium
description: อธิบายสถานการณ์ความจุทั่วไปของ Microsoft Power BI Premium
author: davidiseminger
ms.author: davidi
ms.reviewer: ''
ms.service: powerbi
ms.subservice: powerbi-premium
ms.topic: conceptual
ms.date: 11/11/2020
ms.custom: ''
LocalizationGroup: Premium
ms.openlocfilehash: 21ec2baf472d9650e550de8808ce3dc98b7cb49f
ms.sourcegitcommit: 653e18d7041d3dd1cf7a38010372366975a98eae
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 12/01/2020
ms.locfileid: "96412310"
---
# <a name="premium-capacity-scenarios"></a><span data-ttu-id="a1536-103">สถานการณ์ความจุแบบพรีเมียม</span><span class="sxs-lookup"><span data-stu-id="a1536-103">Premium capacity scenarios</span></span>

<span data-ttu-id="a1536-104">บทความนี้อธิบายสถานการณ์ในโลกแห่งความจริงที่ความจุแบบพรีเมียมของ Power BI ได้ถูกนำไปใช้</span><span class="sxs-lookup"><span data-stu-id="a1536-104">This article describes real-world scenarios where Power BI premium capacities have been implemented.</span></span> <span data-ttu-id="a1536-105">มีการอธิบายปัญหาและความท้าทายที่พบบ่อยไว้แล้ว รวมถึงวิธีการระบุปัญหาและช่วยแก้ไขปัญหา:</span><span class="sxs-lookup"><span data-stu-id="a1536-105">Common issues and challenges are described, also how to identify issues, and help resolve them:</span></span>

- [<span data-ttu-id="a1536-106">การปรับปรุงชุดข้อมูลให้เป็นปัจจุบัน</span><span class="sxs-lookup"><span data-stu-id="a1536-106">Keeping datasets up-to-date</span></span>](#keeping-datasets-up-to-date)
- [<span data-ttu-id="a1536-107">การระบุชุดข้อมูลที่ตอบสนองช้า</span><span class="sxs-lookup"><span data-stu-id="a1536-107">Identifying slow-responding datasets</span></span>](#identifying-slow-responding-datasets)
- [<span data-ttu-id="a1536-108">การระบุสาเหตุสำหรับชุดข้อมูลที่ตอบสนองช้าเป็นระยะ ๆ </span><span class="sxs-lookup"><span data-stu-id="a1536-108">Identifying causes for sporadically slow-responding datasets</span></span>](#identifying-causes-for-sporadically-slow-responding-datasets)
- [<span data-ttu-id="a1536-109">การตรวจสอบว่ามีหน่วยความจำเพียงพอหรือไม่</span><span class="sxs-lookup"><span data-stu-id="a1536-109">Determining whether there is enough memory</span></span>](#determining-whether-there-is-enough-memory)
- [<span data-ttu-id="a1536-110">การตรวจสอบว่ามี CPU เพียงพอหรือไม่</span><span class="sxs-lookup"><span data-stu-id="a1536-110">Determining whether there is enough CPU</span></span>](#determining-whether-there-is-enough-cpu)

<span data-ttu-id="a1536-111">ขั้นตอน พร้อมกับตัวอย่างแผนภูมิและตารางมาจาก **แอป Power BI Premium Capacity Metric** ที่ผู้ดูแลระบบ Power BI จะสามารถเข้าถึงได้</span><span class="sxs-lookup"><span data-stu-id="a1536-111">The steps, along with chart and table examples are from the **Power BI Premium Capacity Metrics app** that a Power BI administrator will have access to.</span></span>

> [!NOTE]
> <span data-ttu-id="a1536-112">Power BI Premium เพิ่งเปิดตัว Premium เวอร์ชันใหม่ชื่อ **Premium Gen2** ซึ่งกำลังอยู่ในช่วงการแสดงตัวอย่าง</span><span class="sxs-lookup"><span data-stu-id="a1536-112">Power BI Premium recently released a new version of Premium, called **Premium Gen2**, which is currently in preview.</span></span> <span data-ttu-id="a1536-113">Premium Gen2 จะทำให้การจัดการความจุระดับพรีเมียมง่ายขึ้นและลดค่าใช้จ่ายในการจัดการ</span><span class="sxs-lookup"><span data-stu-id="a1536-113">Premium Gen2 will simplify the management of Premium capacities, and reduce management overhead.</span></span> <span data-ttu-id="a1536-114">สำหรับข้อมูลเพิ่มเติม โปรดดูที่ [Power BI Premium Generation 2 (ตัวอย่าง)](service-premium-what-is.md#power-bi-premium-generation-2-preview)</span><span class="sxs-lookup"><span data-stu-id="a1536-114">For more information, see [Power BI Premium Generation 2 (preview)](service-premium-what-is.md#power-bi-premium-generation-2-preview).</span></span>

## <a name="keeping-datasets-up-to-date"></a><span data-ttu-id="a1536-115">การปรับปรุงชุดข้อมูลให้เป็นปัจจุบัน</span><span class="sxs-lookup"><span data-stu-id="a1536-115">Keeping datasets up to date</span></span>

<span data-ttu-id="a1536-116">ในสถานการณ์นี้ การตรวจสอบถูกทริกเกอร์เมื่อผู้ใช้ร้องเรียนว่าข้อมูลรายงานในบางครั้งดูเหมือนว่าเก่าหรือ “ไม่เป็นปัจจุบัน”</span><span class="sxs-lookup"><span data-stu-id="a1536-116">In this scenario, an investigation was triggered when users complained that report data sometimes appeared to be old or "stale".</span></span>

<span data-ttu-id="a1536-117">ในแอป ผู้ดูแลระบบโต้ตอบกับวิชวล **รีเฟรช** จากนั้นเรียงลำดับชุดข้อมูลโดยสถิติ **เวลารอสูงสุด** จากมากไปน้อย</span><span class="sxs-lookup"><span data-stu-id="a1536-117">In the app, the admin interacts with the **Refreshes** visual, sorting datasets by the **Max Wait Time** statistics in descending order.</span></span> <span data-ttu-id="a1536-118">วิชวลนี้ช่วยให้พวกเขาแสดงชุดข้อมูลที่มีเวลารอนานที่สุด ซึ่งจัดกลุ่มตามชื่อพื้นที่ทำงาน</span><span class="sxs-lookup"><span data-stu-id="a1536-118">This visual helps them reveal datasets having the longest wait times, grouped by workspace name.</span></span>

![ชุดข้อมูลจะรีเฟรชโดยเรียงลำดับตามเวลารอสูงสุดจากมากไปน้อย, จัดกลุ่มตามพื้นที่ทำงาน](media/service-premium-capacity-scenarios/dataset-refreshes.png)

<span data-ttu-id="a1536-120">ในวิชวล **เวลารอรีเฟรชโดยเฉลี่ยต่อชั่วโมง** พวกเขาจะสังเกตเห็นว่าเวลารอรีเฟรชสูงสุดอยู่ที่เวลาประมาณ 16.00 น. ในแต่ละวันอย่างสม่ำเสมอ</span><span class="sxs-lookup"><span data-stu-id="a1536-120">In the **Hourly Average Refresh Wait Times** visual, they notice that the refresh wait times peak consistently around 4PM each day.</span></span>

![การรอรีเฟรชสูงสุดเป็นระยะ ๆ ที่เวลา 16.00 น.](media/service-premium-capacity-scenarios/peak-refresh-waits.png)

<span data-ttu-id="a1536-122">มีคำอธิบายที่เป็นไปได้มากมายสำหรับผลลัพธ์เหล่านี้:</span><span class="sxs-lookup"><span data-stu-id="a1536-122">There are several possible explanations for these results:</span></span>

- <span data-ttu-id="a1536-123">มีความพยายามในการรีเฟรชมากเกินไปในเวลาเดียวกัน ซึ่งเกินขีดจำกัดที่กำหนดโดยโหนดความจุ</span><span class="sxs-lookup"><span data-stu-id="a1536-123">Too many refresh attempts could be occurring at the same time, exceeding the limits defined by the capacity node.</span></span> <span data-ttu-id="a1536-124">ในกรณีนี้ เป็นการรีเฟรชพร้อมกันหกครั้งบน P1 ที่มีการจัดสรรหน่วยความจำเริ่มต้น</span><span class="sxs-lookup"><span data-stu-id="a1536-124">In this case, six concurrent refreshes on a P1 with default memory allocation.</span></span>

- <span data-ttu-id="a1536-125">ชุดข้อมูลที่จะรีเฟรชอาจมีขนาดใหญ่เกินไปที่จะพอดีกับหน่วยความจำที่มีอยู่ (ต้องใช้หน่วยความจำอย่างน้อย 2 เท่าสำหรับการรีเฟรชเต็มรูปแบบ)</span><span class="sxs-lookup"><span data-stu-id="a1536-125">Datasets to be refreshed may be too large to fit into available memory (requiring at least 2x the memory required for full refresh).</span></span>
- <span data-ttu-id="a1536-126">ตรรกะ Power Query ที่ไม่มีประสิทธิภาพอาจส่งผลให้อัตราการใช้งานหน่วยความจำเพิ่มขึ้นอย่างรวดเร็วทันทีทันใดในระหว่างการรีเฟรชชุดข้อมูล</span><span class="sxs-lookup"><span data-stu-id="a1536-126">Inefficient Power Query logic may be resulting in a memory usage spike during dataset refresh.</span></span> <span data-ttu-id="a1536-127">ในความจุที่ไม่ว่าง บางครั้งอัตราการเพิ่มขึ้นอย่างรวดเร็วทันทีทันใดอาจถึงขีดจำกัดทางกายภาพ ล้มเหลวในการรีเฟรชและอาจส่งผลต่อการดำเนินการบนมุมมองรายงานอื่น ๆ</span><span class="sxs-lookup"><span data-stu-id="a1536-127">On a busy capacity, this spike can occasionally reach the physical limit, failing the refresh and potentially affecting other report view operations on the capacity.</span></span>
- <span data-ttu-id="a1536-128">ชุดข้อมูลที่มีการคิวรีบ่อยครั้งที่จำเป็นต้องอยู่ในหน่วยความจำอาจส่งผลต่อความสามารถของชุดข้อมูลอื่นในการรีเฟรชเพราะว่าหน่วยความจำที่มีอยู่แบบจำกัด</span><span class="sxs-lookup"><span data-stu-id="a1536-128">Frequently queried datasets that need to stay in memory may affect the ability of other datasets to refresh because of limited available memory.</span></span>

<span data-ttu-id="a1536-129">เพื่อช่วยในการตรวจสอบ ผู้ดูแลระบบ Power BI สามารถค้นหา:</span><span class="sxs-lookup"><span data-stu-id="a1536-129">To help investigate, the Power BI administrator can look for:</span></span>

- <span data-ttu-id="a1536-130">หน่วยความจำเหลือน้อยในขณะที่รีเฟรชข้อมูลเมื่อหน่วยความจำที่มีอยู่มีขนาดน้อยกว่า 2 เท่าของชุดข้อมูลที่จะรีเฟรช</span><span class="sxs-lookup"><span data-stu-id="a1536-130">Low available memory at the time of data refreshes when available memory is less than 2x the size of the dataset to be refreshed.</span></span>
- <span data-ttu-id="a1536-131">ชุดข้อมูลที่ไม่ได้ถูกรีเฟรชและไม่ได้อยู่ในหน่วยความจำก่อนการรีเฟรช แต่ยังเริ่มต้นแสดงปริมาณการใช้งานแบบโต้ตอบในช่วงเวลาที่มีการรีเฟรชมาก</span><span class="sxs-lookup"><span data-stu-id="a1536-131">Datasets not being refreshed and not in memory before refresh, yet started to show interactive traffic during heavy refresh times.</span></span> <span data-ttu-id="a1536-132">หากต้องการดูชุดข้อมูลที่โหลดลงในหน่วยความจำ ณ เวลาใดก็ตาม ผู้ดูแลระบบ Power BI สามารถดูพื้นที่ชุดข้อมูลของแท็บ **ชุดข้อมูล** ในแอปได้</span><span class="sxs-lookup"><span data-stu-id="a1536-132">To see which datasets are loaded into memory at any given time, a Power BI administrator can look at the datasets area of the **Datasets** tab in the app.</span></span> <span data-ttu-id="a1536-133">จากนั้นผู้ดูแลระบบสามารถกรองข้ามไปยังเวลาที่กำหนดโดยการคลิกที่หนึ่งในแท่งในวิชวล **จำนวนชุดข้อมูลที่โหลดต่อชั่วโมง**</span><span class="sxs-lookup"><span data-stu-id="a1536-133">The admin can then cross-filter to a given time by clicking on one of the bars in the **Hourly Loaded Dataset Counts**.</span></span> <span data-ttu-id="a1536-134">อัตราการเพิ่มขึ้นอย่างรวดเร็วทันทีทันใดภายในที่แสดงในภาพด้านล่าง ระบุหนึ่งชั่วโมงเมื่อโหลดชุดข้อมูลหลายชุดลงในหน่วยความจำ ซึ่งอาจชะลอการเริ่มต้นการรีเฟรชตามกำหนดเวลา</span><span class="sxs-lookup"><span data-stu-id="a1536-134">A local spike, shown in the below image, indicates an hour when multiple datasets were loaded into memory, which could delay the start of scheduled refreshes.</span></span>
- <span data-ttu-id="a1536-135">การลดสัดส่วนชุดข้อมูลเพิ่มมากขึ้นเมื่อมีการกำหนดเวลาเพื่อเริ่มต้นการรีเฟรชข้อมูล</span><span class="sxs-lookup"><span data-stu-id="a1536-135">Increased dataset evictions taking place when data refreshes are scheduled to start.</span></span> <span data-ttu-id="a1536-136">การลดสัดส่วนสามารถบ่งบอกว่ามีความกดดันบนหน่วยความจำอย่างสูงซึ่งเกิดจากการให้บริการรายงานเชิงโต้ตอบที่แตกต่างกันมากเกินไปก่อนเวลารีเฟรช</span><span class="sxs-lookup"><span data-stu-id="a1536-136">Evictions can indicate that there was high memory pressure caused by serving too many different interactive reports before refresh.</span></span> <span data-ttu-id="a1536-137">วิชวล **การลดสัดส่วนข้อมูลต่อชั่วโมงและปริมาณการใช้หน่วยความจำ** สามารถระบุอัตราการลดสัดส่วนที่เพิ่มขึ้นอย่างรวดเร็วทันทีทันใดได้อย่างชัดเจน</span><span class="sxs-lookup"><span data-stu-id="a1536-137">The **Hourly Dataset Evictions and Memory Consumption** visual can clearly indicate spikes in evictions.</span></span>

<span data-ttu-id="a1536-138">รูปต่อไปนี้แสดงการเพิ่มขึ้นภายในในชุดข้อมูลที่โหลด ซึ่งบ่งบอกว่าการคิวรีแบบโต้ตอบจะเริ่มต้นการรีเฟรชช้า</span><span class="sxs-lookup"><span data-stu-id="a1536-138">The following image shows a local spike in loaded datasets, which suggests interactive querying delayed the start of refreshes.</span></span> <span data-ttu-id="a1536-139">การเลือกระยะเวลาในวิชวล **จำนวนชุดข้อมูลที่โหลดต่อชั่วโมง** จะกรองข้ามวิชวล **ขนาดของชุดข้อมูล**</span><span class="sxs-lookup"><span data-stu-id="a1536-139">Selecting a time period in the **Hourly Loaded Dataset Counts** visual will cross-filter the **Dataset Sizes** visual.</span></span>

![รูปต่อไปนี้แสดงอัตราการเพิ่มขึ้นอย่างรวดเร็วทันทีทันใดภายในในชุดข้อมูลที่โหลด ซึ่งบ่งบอกว่าการคิวรีแบบโต้ตอบจะเริ่มต้นการรีเฟรชช้า](media/service-premium-capacity-scenarios/hourly-loaded-dataset-counts.png)

<span data-ttu-id="a1536-141">ผู้ดูแลระบบ Power BI อาจจะพยายามแก้ไขปัญหาโดยทำตามขั้นตอนเพื่อให้แน่ใจว่ามีหน่วยความจำเพียงพอสำหรับการรีเฟรชข้อมูลที่จะเริ่มต้นโดย:</span><span class="sxs-lookup"><span data-stu-id="a1536-141">The Power BI administrator can attempt to resolve the issue by taking steps to ensure that sufficient memory is available for data refreshes to start by:</span></span>

- <span data-ttu-id="a1536-142">ติดต่อเจ้าของชุดข้อมูลและขอให้พวกเขาสลับและเว้นระยะเวลาในการรีเฟรชข้อมูล</span><span class="sxs-lookup"><span data-stu-id="a1536-142">Contacting dataset owners and asking them to stagger and space out data refresh schedules.</span></span>
- <span data-ttu-id="a1536-143">ลดการโหลดคิวรีชุดข้อมูลโดยการลบแดชบอร์ดหรือไทล์แดชบอร์ดที่ไม่จำเป็นออก โดยเฉพาะอย่างยิ่งเนื้อหาที่บังคับใช้การรักษาความปลอดภัยระดับแถว</span><span class="sxs-lookup"><span data-stu-id="a1536-143">Reducing dataset query load by removing unnecessary dashboards or dashboard tiles, especially content that enforces row-level security.</span></span>
- <span data-ttu-id="a1536-144">เร่งความเร็วการรีเฟรชข้อมูลโดยปรับตรรกะ Power Query ให้เหมาะสม</span><span class="sxs-lookup"><span data-stu-id="a1536-144">Speeding data refreshes by optimizing Power Query logic.</span></span> <span data-ttu-id="a1536-145">ปรับปรุงการสร้างแบบจำลองคอลัมน์หรือตารางจากการคำนวณ</span><span class="sxs-lookup"><span data-stu-id="a1536-145">Improve modeling calculated columns or tables.</span></span> <span data-ttu-id="a1536-146">ลดขนาดชุดข้อมูลหรือกำหนดค่าชุดข้อมูลขนาดใหญ่เพื่อดำเนินการรีเฟรชข้อมูลแบบเพิ่มหน่วย</span><span class="sxs-lookup"><span data-stu-id="a1536-146">Reduce dataset sizes or configure larger datasets to perform incremental data refresh.</span></span>

## <a name="identifying-slow-responding-datasets"></a><span data-ttu-id="a1536-147">ระบุชุดข้อมูลที่ตอบสนองช้า</span><span class="sxs-lookup"><span data-stu-id="a1536-147">Identifying slow-responding datasets</span></span>

<span data-ttu-id="a1536-148">ในสถานการณ์นี้ การตรวจสอบเริ่มต้นขึ้นเมื่อผู้ใช้ร้องเรียนว่ารายงานบางฉบับใช้เวลานการเปิดนานเกินไป</span><span class="sxs-lookup"><span data-stu-id="a1536-148">In this scenario, an investigation began when users complained that certain reports took too long to open.</span></span> <span data-ttu-id="a1536-149">บางครั้งรายงานจะหยุดการตอบสนอง</span><span class="sxs-lookup"><span data-stu-id="a1536-149">Sometimes the reports would stop responding.</span></span>

<span data-ttu-id="a1536-150">ในแอป ผู้ดูแลระบบ Power BI สามารถใช้วิชวล **ระยะเวลาคิวรี** เพื่อระบุชุดข้อมูลแย่ที่สุด โดยเรียงลำดับชุดข้อมูลตาม **ระยะเวลาเฉลี่ย** จากมากไปหาน้อย</span><span class="sxs-lookup"><span data-stu-id="a1536-150">In the app, the Power BI administrator can use the **Query Durations** visual to determine the worst-performing datasets by sorting datasets by descending **Average Duration**.</span></span> <span data-ttu-id="a1536-151">วิชวลนี้ยังแสดงจำนวนคิวรีของชุดข้อมูล ดังนั้นคุณสามารถดูความถี่ของการคิวรีชุดข้อมูลได้</span><span class="sxs-lookup"><span data-stu-id="a1536-151">This visual also shows dataset query counts, so you can see how often the datasets are queried.</span></span>

![ชุดข้อมูลที่มีประสิทธิภาพแย่ที่สุด](media/service-premium-capacity-scenarios/worst-performing-datasets.png)

<span data-ttu-id="a1536-153">ผู้ดูแลระบบสามารถดูวิชวล **การกระจายระยะเวลาคิวรี** ซึ่งแสดงการกระจายประสิทธิภาพคิวรีแบบจัดกลุ่มโดยภาพรวม (<= 30ms, 0-100ms) สำหรับช่วงเวลาที่กรองแล้ว</span><span class="sxs-lookup"><span data-stu-id="a1536-153">The administrator can refer to the **Query Duration Distribution** visual, which shows an overall distribution of bucketed query performance (<= 30ms, 0-100ms) for the filtered time period.</span></span> <span data-ttu-id="a1536-154">โดยทั่วไป คิวรีที่ใช้เวลาหนึ่งวินาทีหรือน้อยกว่านั้นถือว่าตอบโจทย์กับผู้ใช้ส่วนใหญ่</span><span class="sxs-lookup"><span data-stu-id="a1536-154">Generally, queries that take one second or less are considered responsive by most users.</span></span> <span data-ttu-id="a1536-155">คิวรีที่ใช้เวลานานกว่ามักจะสร้างการรับรู้ถึงประสิทธิภาพที่ไม่ดี</span><span class="sxs-lookup"><span data-stu-id="a1536-155">Queries that take longer tend to create a perception of bad performance.</span></span>

<span data-ttu-id="a1536-156">วิชวล **การกระจายระยะเวลาคิวรีต่อชั่วโมง** ช่วยให้ผู้ดูแลระบบ Power BI สามารถระบุช่วงเวลาหนึ่งชั่วโมงเมื่อประสิทธิภาพการทำงานของความจุอาจถูกมองว่าไม่ดี</span><span class="sxs-lookup"><span data-stu-id="a1536-156">The **Hourly Query Duration Distribution** visual allows the Power BI administrator to identify one-hour periods when the capacity performance could have been perceived as poor.</span></span> <span data-ttu-id="a1536-157">ยิ่งกลุ่มแถบมีขนาดใหญ่ขึ้นซึ่งแสดงถึงระยะเวลาคิวรีมากกว่าหนึ่งวินาที ยิ่งมีความเสียงว่าผู้ใช้จะรับรู้ประสิทธิภาพที่แย่ลง</span><span class="sxs-lookup"><span data-stu-id="a1536-157">The larger the bar segments that represent query durations over one second, the larger the risk that users will perceive poor performance.</span></span>

<span data-ttu-id="a1536-158">วิชวลเป็นแบบโต้ตอบ และเมื่อเลือกกลุ่มของแถบ วิชวลตาราง **ระยะเวลาคิวรี** ที่สอดคล้องกันบนหน้ารายงานจะถูกกรองข้ามเพื่อแสดงชุดข้อมูลที่วิชวลแสดง</span><span class="sxs-lookup"><span data-stu-id="a1536-158">The visual is interactive, and when a segment of the bar is selected, the corresponding **Query Durations** table visual on the report page is cross-filtered to show the datasets it represents.</span></span> <span data-ttu-id="a1536-159">การกรองข้ามช่วยให้ผู้ดูแลระบบ Power BI สามารถระบุชุดข้อมูลที่ตอบสนองช้าได้อย่างง่ายดาย</span><span class="sxs-lookup"><span data-stu-id="a1536-159">This cross-filtering allows the Power BI administrator to easily identify which datasets are responding slowly.</span></span>

<span data-ttu-id="a1536-160">รูปต่อไปนี้แสดงวิชวลที่กรองตาม **การกระจายระยะเวลาคิวรีต่อชั่วโมง** โดยเน้นชุดข้อมูลที่มีประสิทธิภาพแย่ลงในบักเก็ตหนึ่งชั่วโมง</span><span class="sxs-lookup"><span data-stu-id="a1536-160">The following image shows a visual filtered by **Hourly Query Duration Distributions**, focusing on the worst-performing datasets in one-hour buckets.</span></span>

![วิชวลการกระจายระยะเวลาคิวรีต่อชั่วโมงที่กรองแล้วจะแสดงชุดข้อมูลที่มีประสิทธิภาพแย่ลง](media/service-premium-capacity-scenarios/hourly-query-duration-distributions.png)

<span data-ttu-id="a1536-162">หลังจากระบุชุดข้อมูลที่มีประสิทธิภาพไม่ดีในช่วงเวลาหนึ่งชั่วโมงแล้ว ผู้ดูแลระบบ Power BI สามารถตรวจสอบว่าประสิทธิภาพที่ไม่ดีนั้นเกิดจากความจุที่โหลดมากเกินไป หรือเนื่องจากชุดข้อมูลหรือรายงานที่ออกแบบมาไม่ดี</span><span class="sxs-lookup"><span data-stu-id="a1536-162">After the poor-performing dataset in a specific one-hour time span is identified, the Power BI administrator can investigate whether poor performance is caused by an overloaded capacity or due to a poorly designed dataset or report.</span></span> <span data-ttu-id="a1536-163">พวกเขาสามารถดูวิชวล **เวลารอคิวรี** และเรียงลำดับชุดข้อมูลเรียงลำดับตามเวลารอคิวรีโดยเฉลี่ยจากมากไปหาน้อยได้</span><span class="sxs-lookup"><span data-stu-id="a1536-163">They can refer to the **Query Wait Times** visual, and sort datasets by descending average query wait time.</span></span> <span data-ttu-id="a1536-164">ถ้าเปอร์เซ็นต์ของคิวรีที่กำลังรอสูง ความต้องการสำหรับชุดข้อมูลสูงอาจเป็นสาเหตุของการรอคิวรีมากเกินไป</span><span class="sxs-lookup"><span data-stu-id="a1536-164">If a large percentage of queries is waiting, a high demand for the dataset is likely the cause of too many query delays.</span></span> <span data-ttu-id="a1536-165">ถ้าเวลารอคิวรีโดยเฉลี่ยเป็นจริง (> 100 ms) อาจคุ้มค่าที่จะตรวจทานชุดข้อมูลและรายงานเพื่อดูว่าสามารถปรับให้เหมาะสมได้หรือไม่</span><span class="sxs-lookup"><span data-stu-id="a1536-165">If the average query wait time is substantial (> 100 ms), it may be worth reviewing the dataset and report to see if optimizations can be made.</span></span> <span data-ttu-id="a1536-166">ตัวอย่างเช่น มีวิชวลน้อยลงในหน้ารายงานที่กำหนดหรือการปรับนิพจน์ DAX ให้เหมาะสม</span><span class="sxs-lookup"><span data-stu-id="a1536-166">For example, fewer visuals on given report pages or a DAX expression optimization.</span></span>

![วิชวลเวลารอคิวรีช่วยเปิดเผยชุดข้อมูลที่มีประสิทธิภาพต่ำ](media/service-premium-capacity-scenarios/query-wait-times.png)

<span data-ttu-id="a1536-168">มีสาเหตุที่เป็นไปได้หลายประการสำหรับเวลารอคิวรีที่สร้างขึ้นในชุดข้อมูล:</span><span class="sxs-lookup"><span data-stu-id="a1536-168">There are several possible reasons for query wait time buildup in datasets:</span></span>

- <span data-ttu-id="a1536-169">การออกแบบแบบจำลองที่ไม่เหมาะสม นิพจน์หน่วยวัด หรือแม้แต่การออกแบบรายงาน - สถานการณ์ทั้งหมดที่สามารถนำไปสู่การคิวรีที่ใช้เวลานานซึ่งใช้ CPU ระดับสูง</span><span class="sxs-lookup"><span data-stu-id="a1536-169">A suboptimal model design, measure expressions, or even report design - all circumstances that can contribute to long running queries that consume high levels of CPU.</span></span> <span data-ttu-id="a1536-170">ซึ่งบังคับให้คิวรีใหม่ต้องรอจนกว่าเธรด CPU จะพร้อมใช้งานและสามารถสร้างเอฟเฟ็กต์การป้องกัน (เหมือนกับการจราจรติดขัด) ซึ่งมักพบได้ในช่วงเวลาทำการสูงสุด</span><span class="sxs-lookup"><span data-stu-id="a1536-170">This forces new queries to wait until CPU threads become available and can create a convoy effect (think traffic jam), commonly seen during peak business hours.</span></span> <span data-ttu-id="a1536-171">หน้า **การรอคิวรี** จะเป็นทรัพยากรหลักที่จะตรวจสอบว่าชุดข้อมูลมีเวลารอคิวรีโดยเฉลี่ยสูงหรือไม่</span><span class="sxs-lookup"><span data-stu-id="a1536-171">The **Query Waits** page will be the main resource to determine whether datasets have high average query wait times.</span></span>
- <span data-ttu-id="a1536-172">จำนวนผู้ใช้งานความจุพร้อมกันสูง (หลายร้อยถึงหลายพัน) ซึ่งใช้รายงานหรือชุดข้อมูลเดียวกัน</span><span class="sxs-lookup"><span data-stu-id="a1536-172">A high number of concurrent capacity users (hundreds to thousands) consuming the same report or dataset.</span></span> <span data-ttu-id="a1536-173">แม้แต่ชุดข้อมูลที่ออกแบบมาอย่างดีก็อาจทำงานได้ไม่ดีหากเกินค่าเกณฑ์กระบวนการการทำงานพร้อมกัน</span><span class="sxs-lookup"><span data-stu-id="a1536-173">Even well-designed datasets can perform badly beyond a concurrency threshold.</span></span> <span data-ttu-id="a1536-174">ปัญหาด้านประสิทธิภาพการทำงานนี้ดูจากชุดข้อมูลเดียวที่แสดงค่าสำหรับจำนวนคิวรีสูงขึ้นอย่างมาก เมื่อเทียบกับชุดข้อมูลอื่น ๆ</span><span class="sxs-lookup"><span data-stu-id="a1536-174">This performance problem is indicated by a single dataset showing a dramatically higher value for query counts than other datasets.</span></span> <span data-ttu-id="a1536-175">ตัวอย่างเช่น คุณอาจเห็นคิวรี 300K สำหรับชุดข้อมูลหนึ่งเมื่อเทียบกับคิวรี <30K สำหรับชุดข้อมูลอื่น ๆ ทั้งหมด</span><span class="sxs-lookup"><span data-stu-id="a1536-175">For example, you may see 300K queries for one dataset compared to <30K queries for all other datasets.</span></span> <span data-ttu-id="a1536-176">ในบางจุดที่การรอคิวรีสำหรับชุดข้อมูลนี้จะเริ่มจัดสลับ ซึ่งสามารถมองเห็นได้ในวิชวล **ระยะเวลาคิวรี**</span><span class="sxs-lookup"><span data-stu-id="a1536-176">At some point the query waits for this dataset will start to stagger, which can be seen in the **Query Durations** visual.</span></span>
- <span data-ttu-id="a1536-177">ชุดข้อมูลที่แตกต่างกันจำนวนมากที่คิวรีพร้อมกันทำให้เกิดการแธรชชิ่งเนื่องจากชุดข้อมูลมักจะวนเข้าและออกจากหน่วยความจำ</span><span class="sxs-lookup"><span data-stu-id="a1536-177">Many disparate datasets queried concurrently, causing thrashing as datasets frequently cycle in and out of memory.</span></span> <span data-ttu-id="a1536-178">สถานการณ์นี้ส่งผลให้ผู้ใช้ประสบปัญหาประสิทธิภาพการทำงานช้าเมื่อโหลดชุดข้อมูลลงในหน่วยความจำ</span><span class="sxs-lookup"><span data-stu-id="a1536-178">This situation results in users experiencing slow performance when the dataset is loaded into memory.</span></span> <span data-ttu-id="a1536-179">เมื่อต้องยืนยัน ผู้ดูแลระบบ Power BI สามารถอ้างอิงไปยังวิชวล **การลดสัดส่วนชุดข้อมูลต่อชั่วโมงและปริมาณการใช้หน่วยความจำ** ซึ่งอาจบ่งบอกว่าชุดข้อมูลจำนวนมากที่โหลดเข้าสู่หน่วยความจำนั้นถูกสัดส่วนซ้ำ ๆ</span><span class="sxs-lookup"><span data-stu-id="a1536-179">To confirm, the Power BI administrator can refer to the **Hourly Dataset Evictions and Memory Consumption** visual, which may indicate that a high number of datasets loaded into memory are being repeatedly evicted.</span></span>

## <a name="identifying-causes-for-sporadically-slow-responding-datasets"></a><span data-ttu-id="a1536-180">การระบุสาเหตุสำหรับชุดข้อมูลที่ตอบสนองช้าเป็นระยะ</span><span class="sxs-lookup"><span data-stu-id="a1536-180">Identifying causes for sporadically slow-responding datasets</span></span>

<span data-ttu-id="a1536-181">ในสถานการณ์นี้ การตรวจสอบเริ่มต้นขึ้นเมื่อผู้ใช้อธิบายว่าบางครั้งวิชวลรายงานตอบสนองช้าหรืออาจไม่ตอบสนอง</span><span class="sxs-lookup"><span data-stu-id="a1536-181">In this scenario, an investigation began when users described that report visuals sometimes were slow to respond or could become unresponsive.</span></span> <span data-ttu-id="a1536-182">ในบางครั้ง การตอบสนองของวิชวลรายงานก็เป็นที่ยอมรับได้</span><span class="sxs-lookup"><span data-stu-id="a1536-182">At other times the report visuals were acceptably responsive.</span></span>

<span data-ttu-id="a1536-183">ภายในแอป ส่วน **ระยะเวลาคิวรี** ถูกนำมาใช้เพื่อค้นหาชุดข้อมูลที่เป็นสาเหตุในวิธีต่อไปนี้:</span><span class="sxs-lookup"><span data-stu-id="a1536-183">Within the app, the **Query Durations** section was used to find the culprit dataset in the following way:</span></span>

- <span data-ttu-id="a1536-184">ในวิชวลระยะเวลาคิวรี ผู้ดูแลระบบจะกรองชุดข้อมูลโดยชุดข้อมูล (เริ่มต้นจากชุดข้อมูลด้านบนที่คิวรีแล้ว) และตรวจสอบแถบที่กรองข้ามในวิชวล **การกระจายคิวรีต่อชั่วโมง**</span><span class="sxs-lookup"><span data-stu-id="a1536-184">In the Query Durations visual, the admin filtered dataset by dataset (starting at the top datasets queried) and examined the cross filtered bars in the **Hourly Query Distributions** visual.</span></span>
- <span data-ttu-id="a1536-185">เมื่อแถบเวลาหนึ่งชั่วโมงแถบเดียวที่แสดงการเปลี่ยนแปลงที่สำคัญในอัตราส่วนระหว่างกลุ่มระยะเวลาการคิวรีทั้งหมดกับแถบหนึ่งชั่วโมงแถบอื่นสำหรับชุดข้อมูลนั้น (ตัวอย่างเช่น อัตราส่วนระหว่างสีที่เปลี่ยนไปอย่างมาก) ซึ่งหมายถึงชุดข้อมูลนี้แสดงการเปลี่ยนแปลงด้านประสิทธิภาพเป็นระยะ</span><span class="sxs-lookup"><span data-stu-id="a1536-185">When a single one-hour bar showed significant changes in the ratio between all query duration groups vs. other one-hour bars for that dataset (for example, the ratios between the colors changes drastically), it means this dataset demonstrated a sporadic change in performance.</span></span>
- <span data-ttu-id="a1536-186">แถบเวลาหนึ่งชั่วโมง ซึ่งแสดงส่วนของคิวรีที่มีประสิทธิภาพต่ำผิดปกติซึ่งระบุช่วงเวลาที่ชุดข้อมูลนั้นได้รับผลกระทบจากเอฟเฟ็กต์ Noisy Neighbor ซึ่งเกิดจากกิจกรรมของชุดข้อมูลอื่น</span><span class="sxs-lookup"><span data-stu-id="a1536-186">The one-hour bars showing an irregular portion of poor performing queries, indicated a timespan where that dataset was impacted by a noisy neighbor effect, caused by other datasets' activities.</span></span>

<span data-ttu-id="a1536-187">ภาพด้านล่างแสดงระยะเวลาหนึ่งชั่วโมงในวันที่ 30 มกราคม ซึ่งเกิดความล้มเหลวอย่างมีนัยสำคัญในประสิทธิภาพของชุดข้อมูลที่ระบุโดยขนาดของบักเก็ตระยะเวลาการเรียกใช้งาน "(3,10s)"</span><span class="sxs-lookup"><span data-stu-id="a1536-187">The image below shows one hour on January 30, where a significant setback in a dataset's performance occurred, indicated by the size of the "(3,10s]" execution duration bucket.</span></span> <span data-ttu-id="a1536-188">การคลิกที่แถบหนึ่งชั่วโมงจะแสดงชุดข้อมูลทั้งหมดที่โหลดเข้าสู่หน่วยความจำในช่วงเวลานั้น การตัดชุดข้อมูลอาจเป็นสาเหตุของปัญหาที่ทำให้เกิดเอฟเฟ็กต์ Noisy Neighbor</span><span class="sxs-lookup"><span data-stu-id="a1536-188">Clicking that one-hour bar reveals all the datasets loaded into memory during that time, surfacing possible datasets causing the noisy neighbor effect.</span></span>

![แถบที่แสดงประสิทธิภาพการทำงานแย่ที่สุดโดยส่วนใหญ่](media/service-premium-capacity-scenarios/worst-performing-queries.png)

<span data-ttu-id="a1536-190">เมื่อระบุช่วงเวลาที่มีปัญหา (ตัวอย่างเช่น ระหว่างวันที่ 30 มกราคมในภาพด้านบน) ผู้ดูแลระบบ Power BI สามารถลบตัวกรองชุดข้อมูลทั้งหมดแล้วกรองเฉพาะช่วงเวลานั้นเพื่อพิจารณาว่าชุดข้อมูลใดจะถูกคิวรีอย่างแข็งขันในช่วงเวลานี้</span><span class="sxs-lookup"><span data-stu-id="a1536-190">Once a problematic timespan is identified (for example, during Jan. 30th in the image above) the Power BI administrator can remove all dataset filters then filter only by that timespan to determine which datasets were actively queried during this time.</span></span> <span data-ttu-id="a1536-191">ชุดข้อมูลที่เป็นสาเหตุสำหรับเอฟเฟ็กต์ Noisy Neighbor มักจะเป็นชุดข้อมูลที่ถูกคีวรีสูงสุดหรือไม่ก็ชุดข้อมูลที่มีระยะเวลาการคิวรีโดยเฉลี่ยนานที่สุด</span><span class="sxs-lookup"><span data-stu-id="a1536-191">The culprit dataset for the noisy neighbor effect is usually the top queried dataset or the one with the longest average query duration.</span></span>

<span data-ttu-id="a1536-192">วิธีการแก้ไขปัญหานี้อาจเป็นการกระจายชุดข้อมูลที่เป็นสาเหตุผ่านพื้นที่ทำงานที่แตกต่างกันในความจุแบบพรีเมียมที่แตกต่างกัน หรือในความจุที่ใช้ร่วมกันถ้าขนาดของชุดข้อมูล ข้อกำหนดการใช้งาน และรูปแบบการรีเฟรชข้อมูลได้รับการสนับสนุน</span><span class="sxs-lookup"><span data-stu-id="a1536-192">A solution to this problem could be to distribute the culprit datasets over different workspaces on different Premium capacities, or on shared capacity if the dataset size, consumption requirements, and data refresh patterns are supported.</span></span>

<span data-ttu-id="a1536-193">การย้อนกลับอาจเป็นจริงเช่นกัน</span><span class="sxs-lookup"><span data-stu-id="a1536-193">The reverse could be true as well.</span></span> <span data-ttu-id="a1536-194">ผู้ดูแลระบบ Power BI สามารถระบุเวลาที่ประสิทธิภาพการคิวรีของชุดข้อมูลดีขึ้นเป็นอย่างมากแล้วมองหาสิ่งที่หายไป</span><span class="sxs-lookup"><span data-stu-id="a1536-194">The Power BI administrator could identify times when a dataset query performance drastically improves and then look for what disappeared.</span></span> <span data-ttu-id="a1536-195">ถ้าข้อมูลบางอย่างหายไปที่จุดนั้น อาจเป็นการช่วยบ่งชี้ปัญหาที่เกิดขึ้น</span><span class="sxs-lookup"><span data-stu-id="a1536-195">If certain information is missing at that point, then that may help to point to the causing problem.</span></span>

## <a name="determining-whether-there-is-enough-memory"></a><span data-ttu-id="a1536-196">การตรวจสอบว่ามีหน่วยความจำเพียงพอหรือไม่</span><span class="sxs-lookup"><span data-stu-id="a1536-196">Determining whether there is enough memory</span></span>

<span data-ttu-id="a1536-197">เมื่อต้องการตรวจสอบว่าหน่วยความจำมีเพียงพอสำหรับที่จะรองรับความจุของปริมาณงานหรือไม่ ผู้ดูแลระบบ Power BI สามารถดูที่วิชวล **เปอร์เซ็นต์หน่วยความจำที่ใช้แล้ว** ในแท็บ **ชุดข้อมูล** ของแอปได้</span><span class="sxs-lookup"><span data-stu-id="a1536-197">To determine whether there is enough memory for the capacity to complete its workloads, the Power BI administrator can refer to the **Consumed Memory Percentages** visual in the **Datasets** tab of the app.</span></span> <span data-ttu-id="a1536-198">หน่วยความ **ทั้งหมด** (รวม) แสดงหน่วยความจำที่ใช้โดยชุดข้อมูลที่โหลดลงในหน่วยความจำ โดยไม่คำนึงถึงว่าชุดข้อมูลเหล่านี้ถูกคิวรีหรือประมวลผลอย่างแข็งขันหรือไม่</span><span class="sxs-lookup"><span data-stu-id="a1536-198">**All** (total) memory represents the memory consumed by datasets loaded into memory, regardless of whether they are actively queried or processed.</span></span> <span data-ttu-id="a1536-199">หน่วยความจำ **ที่ใช้งานอยู่** แสดงหน่วยความจำที่ใช้โดยชุดข้อมูลที่กำลังถูกประมวลผลอย่างแข็งขัน</span><span class="sxs-lookup"><span data-stu-id="a1536-199">**Active** memory represents the memory consumed by datasets that are being actively processed.</span></span>

<span data-ttu-id="a1536-200">ในความจุที่สภาพพร้อมใช้งาน ภาพจะมีลักษณะดังนี้ แสดงช่องว่างระหว่างหน่วยความจำทั้งหมด (รวม) และหน่วยความจำที่ใช้งานอยู่:</span><span class="sxs-lookup"><span data-stu-id="a1536-200">In a healthy capacity the visual will look like this, showing a gap between All (total) and Active memory:</span></span>

![ความจุที่สภาพพร้อมใช้งานจะแสดงความแตกต่างระหว่างหน่วยความจำทั้งหมด (รวม) และหน่วยความจำที่ใช้งานอยู่](media/service-premium-capacity-scenarios/memory-healthy-capacity.png)

<span data-ttu-id="a1536-202">ในความจุเกิดความกดดันบนหน่วยความจำ วิชวลเดียวกันจะแสดงการบรรจบกันของหน่วยความจำที่ใช้งานอยู่และหน่วยความจำทั้งหมดอย่างชัดเจน ซึ่งหมายความว่าคุณจะไม่สามารถโหลดชุดข้อมูลเพิ่มเติมลงในหน่วยความจำได้อีก</span><span class="sxs-lookup"><span data-stu-id="a1536-202">In a capacity experiencing memory pressure, the same visual will clearly show active memory and total memory converging, meaning that it is impossible to load additional datasets into memory then.</span></span> <span data-ttu-id="a1536-203">ในกรณีนี้ ผู้ดูแลระบบ Power BI สามารถคลิก **รีสตาร์ทความจุ** (ใน **ตัวเลือกขั้นสูง** ของพื้นที่การตั้งค่าความจุของพอร์ทัลผู้ดูแลระบบ) ได้</span><span class="sxs-lookup"><span data-stu-id="a1536-203">In this case, the Power BI administrator can click **Capacity Restart** (in **Advanced Options** of the capacity settings area of the admin portal).</span></span> <span data-ttu-id="a1536-204">การรีสตาร์ทความจุจะส่งผลให้ชุดข้อมูลทั้งหมดถูกล้างออกจากหน่วยความจำและอนุญาตให้โหลดซ้ำลงในหน่วยความจำได้ตามต้องการ (โดยการคิวรีหรือการรีเฟรชข้อมูล)</span><span class="sxs-lookup"><span data-stu-id="a1536-204">Restarting the capacity results in all datasets being flushed from memory and allowing them to reload into memory as required (by queries or data refresh).</span></span>

> [!NOTE]
> <span data-ttu-id="a1536-205">สำหรับ Premium Gen2 ไม่จำเป็นต้องติดตามการใช้หน่วยความจำ</span><span class="sxs-lookup"><span data-stu-id="a1536-205">For Premium Gen2, memory consumption does not need to be tracked.</span></span> <span data-ttu-id="a1536-206">ข้อจำกัดเพียงอย่างเดียวใน Premium Gen2 คือฟุตพริ้นท์หน่วยความจำของอาร์ทิแฟกต์เดียว</span><span class="sxs-lookup"><span data-stu-id="a1536-206">The only limitation in Premium Gen2 is on the memory footprint of a single artifact.</span></span> <span data-ttu-id="a1536-207">ฟุตพริ้นท์ไม่สามารถเกินหน่วยความจำที่มีอยู่ในความจุได้</span><span class="sxs-lookup"><span data-stu-id="a1536-207">The footprint cannot exceed the memory available on the capacity.</span></span> <span data-ttu-id="a1536-208">สำหรับข้อมูลเพิ่มเติมเกี่ยวกับ Premium Gen2 โปรดดูที่ [Power BI Premium Generation 2 (ตัวอย่าง)](service-premium-what-is.md#power-bi-premium-generation-2-preview)</span><span class="sxs-lookup"><span data-stu-id="a1536-208">For more information about Premium Gen2, see [Power BI Premium Generation 2 (preview)](service-premium-what-is.md#power-bi-premium-generation-2-preview).</span></span>

![หน่วยความจำ **ที่ใช้งานอยู่** ซึ่งบรรจบกับหน่วยความจำ \*\* ทั้งหมด \*\*](media/service-premium-capacity-scenarios/memory-unhealthy-capacity.png)

## <a name="determining-whether-there-is-enough-cpu"></a><span data-ttu-id="a1536-210">การตรวจสอบว่ามี CPU เพียงพอหรือไม่</span><span class="sxs-lookup"><span data-stu-id="a1536-210">Determining whether there is enough CPU</span></span>

<span data-ttu-id="a1536-211">โดยทั่วไป การใช้งาน CPU โดยเฉลี่ยของความจุควรต่ำกว่า 80%</span><span class="sxs-lookup"><span data-stu-id="a1536-211">In general, a capacity's average CPU utilization should remain below 80%.</span></span> <span data-ttu-id="a1536-212">การใช้งานเกินค่านี้หมายความว่าความจุกำลังใกล้ถึงความอิ่มตัวของ CPU</span><span class="sxs-lookup"><span data-stu-id="a1536-212">Exceeding this value means the capacity is approaching CPU saturation.</span></span>

<span data-ttu-id="a1536-213">ผลกระทบจากความอิ่มตัวของ CPU จะเห็นได้จากการทำงานที่ใช้เวลานานกว่าที่ควรจะเป็นเนื่องจากความจุที่ใช้บริบทของ CPU จำนวนมากจะสลับขณะที่พยายามประมวลผลการทำงานทั้งหมด</span><span class="sxs-lookup"><span data-stu-id="a1536-213">Effects of CPU saturation are expressed by operations taking longer than they should, due to the capacity performing many CPU contexts switches as it attempts to process all operations.</span></span> <span data-ttu-id="a1536-214">ในความจุแบบพรีเมียมที่มีจำนวนคิวรีที่เกิดขึ้นพร้อมกันสูง นั่นหมายถึงเวลารอคิวรีสูง</span><span class="sxs-lookup"><span data-stu-id="a1536-214">In a Premium capacity with a high number of concurrent queries, this is indicated by high query wait times.</span></span> <span data-ttu-id="a1536-215">ผลที่ตามมาจากเวลารอคิวรีสูงคือการตอบสนองช้าลงกว่าปกติ</span><span class="sxs-lookup"><span data-stu-id="a1536-215">A consequence of high query wait times is slower responsiveness than usual.</span></span> <span data-ttu-id="a1536-216">ผู้ดูแลระบบ Power BI สามารถระบุได้อย่างง่ายดายเมื่อ CPU มีความอิ่มตัวแล้วโดยดูที่วิชวล **การกระจายเวลารอคิวรีต่อชั่วโมง** ้</span><span class="sxs-lookup"><span data-stu-id="a1536-216">The Power BI administrator can easily identify when the CPU is saturated by viewing the **Hourly Query Wait Time Distributions** visual.</span></span> <span data-ttu-id="a1536-217">จำนวนเวลารอคิวรีที่ถึงระดับสูงสุดเป็นระยะ ๆ แสดงถึงความอิ่มตัวของ CPU ที่อาจเกิดขึ้น</span><span class="sxs-lookup"><span data-stu-id="a1536-217">Periodic peaks of query wait time counts indicate potential CPU saturation.</span></span>

![จำนวนเวลารอคิวรีที่ถึงระดับสูงสุดเป็นระยะ ๆ แสดงถึงความอิ่มตัวของ CPU ที่อาจเกิดขึ้น](media/service-premium-capacity-scenarios/peak-query-wait-times.png)

<span data-ttu-id="a1536-219">ในบางครั้งสามารถตรวจหารูปแบบที่คล้ายกันได้ในการทำงานแบบเบื้องหลังหากการทำงานเหล่านั้นมีส่วนทำให้เกิดความอิ่มต้วของ CPU</span><span class="sxs-lookup"><span data-stu-id="a1536-219">A similar pattern can sometimes be detected in background operations if they contribute to CPU saturation.</span></span> <span data-ttu-id="a1536-220">ผู้ดูแลระบบ Power BI สามารถค้นหาอัตราการเพิ่มขึ้นอย่างรวดเร็วทันทีทันใดเป็นระยะ ๆ ในช่วงเวลาการรีเฟรชสำหรับชุดข้อมูลเฉพาะ ซึ่งสามารถระบุความอิ่มตัวของ CPU ในเวลานั้น (อาจเป็นเพราะว่าชุดข้อมูลอื่นที่กำลังดำเนินการรีเฟรชและ/หรือคิวรีแบบโต้ตอบ)</span><span class="sxs-lookup"><span data-stu-id="a1536-220">A Power BI administrator can look for a periodic spike in refresh times for a specific dataset, which can indicate CPU saturation at the time (probably because of other ongoing dataset refreshes and/or interactive queries).</span></span> <span data-ttu-id="a1536-221">ในอินสแตนซ์นี้ การอ้างอิงไปยังมุมมอง **ระบบ** ในแอปอาจไม่จำเป็นต้องแสดงว่า CPU อยู่ในระดับ 100%</span><span class="sxs-lookup"><span data-stu-id="a1536-221">In this instance, referring to the **System** view in the app may not necessarily reveal that the CPU is at 100%.</span></span> <span data-ttu-id="a1536-222">มุมมอง **ระบบ** แสดงค่าเฉลี่ยต่อชั่วโมง แต่ CPU อาจจะอิ่มตัวเป็นเวลาหลายนาทีจากการทำงานหนัก ซึ่งแสดงเป็นอัตราเวลารอที่เพิ่มขึ้นอย่างรวดเร็วทันทีทันใด</span><span class="sxs-lookup"><span data-stu-id="a1536-222">The **System** view displays hourly averages, but the CPU can become saturated for several minutes of heavy operations, which shows up as spikes in wait times.</span></span>

<span data-ttu-id="a1536-223">มีรายละเอียดปลีกย่อยเพิ่มเติมในการดูผลกระทบจากความอิ่มตัวของ CPU</span><span class="sxs-lookup"><span data-stu-id="a1536-223">There are more nuances to seeing the effect of CPU saturation.</span></span> <span data-ttu-id="a1536-224">ในขณะที่จำนวนคิวรีที่รอเป็นสิ่งสำคัญ แต่เวลารอคิวรีจะเกิดขึ้นในระดับหนึ่งเสมอโดยไม่ทำให้ประสิทธิภาพการทำงานลดลง</span><span class="sxs-lookup"><span data-stu-id="a1536-224">While the number of queries that wait is important, query wait time will always happen to some extent without causing discernable performance degradation.</span></span> <span data-ttu-id="a1536-225">ชุดข้อมูลบางชุด (ที่มีเวลาคิวรีโดยเฉลี่ยที่ยาวกว่า แสดงถึงความซับซ้อนหรือขนาด) มีแนวโน้มที่จะทำให้เกิดความอิ่มตัวของ CPU มากกว่าชุดอื่น</span><span class="sxs-lookup"><span data-stu-id="a1536-225">Some datasets (with lengthier average query time, indicating complexity or size) are more prone to the effects of CPU saturation than others.</span></span> <span data-ttu-id="a1536-226">หากต้องการระบุชุดข้อมูลเหล่านี้ได้อย่างง่ายดาย ผู้ดูแลระบบ Power BI สามารถดูการเปลี่ยนแปลงในส่วนประกอบสีของแถบในวิชวล **การกระจายเวลารอต่อชั่วโมง**</span><span class="sxs-lookup"><span data-stu-id="a1536-226">To easily identify these datasets, the Power BI administrator can look for changes in the color composition of the bars in the **Hourly Wait Time Distribution** visual.</span></span> <span data-ttu-id="a1536-227">หลังจากตรวจพบแถบค่าผิดปกติ ผู้ดูแลระบบสามารถค้นหาชุดข้อมูลที่มีการรอคิวรีอยู่ในช่วงเวลานั้น และดูเวลารอคิวรีโดยฉลี่ยโดยเปรียบเทียบกับระยะเวลาคิวรีโดยเฉลี่ย</span><span class="sxs-lookup"><span data-stu-id="a1536-227">After spotting an outlier bar, they can look for the datasets that had query waits during that time and also look at the average query wait time compared to average query duration.</span></span> <span data-ttu-id="a1536-228">ทเมื่อทั้งสองเมตริกมีขนาดเท่ากันและปริมาณงานของคิวรีสำหรับชุดข้อมูลนั้นมีความสำคัญ อาจเป็นไปได้ว่าชุดข้อมูลนั้นได้รับผลกระทบจาก CPU ไม่เพียงพอ</span><span class="sxs-lookup"><span data-stu-id="a1536-228">When these two metrics are of the same magnitude and the query workload for the dataset is non-trivial, it is likely that the dataset is impacted by insufficient CPU.</span></span>

<span data-ttu-id="a1536-229">ผลกระทบนี้สามารถเห็นได้ชัดโดยเฉพาะอย่างยิ่งเมื่อชุดข้อมูลถูกใช้งานในช่วงการส่งชุดข้อมูลสั้น ๆ จากการคิวรีที่มีความถี่สูงโดยผู้ใช้หลายคน (ตัวอย่างเช่น ในช่วงการฝึกอบรม) ซึ่งส่งผลให้เกิดความอิ่มตัวของ CPU ในแต่ละครั้ง</span><span class="sxs-lookup"><span data-stu-id="a1536-229">This effect can be especially apparent when a dataset is consumed in short bursts of high frequency queries by multiple users (for example, in a training session), resulting in CPU saturation during each burst.</span></span> <span data-ttu-id="a1536-230">ในกรณีนี้ เวลารอคิวรีที่สำคัญในชุดข้อมูลนี้อาจได้รับผลกระทบ รวมถึงมีผลกระทบต่อชุดข้อมูลอื่น ๆ ในความจุ (เอฟเฟ็กต์ Noisy Neighbor)</span><span class="sxs-lookup"><span data-stu-id="a1536-230">In this case, significant query wait times on this dataset can be experienced as well as impacting on other datasets in the capacity (noisy neighbor effect).</span></span>

<span data-ttu-id="a1536-231">ในบางกรณี ผู้ดูแลระบบ Power BI สามารถขอให้เจ้าของชุดข้อมูลสร้างปริมาณงานของคิวรีที่มีความผันผวนน้อยลงโดยการสร้างแดชบอร์ด (ซึ่งจะทำการคิวรีเป็นระยะ ๆ กับการรีเฟรชชุดข้อมูลใด ๆ สำหรับไทล์ที่แคช) แทนรายงาน</span><span class="sxs-lookup"><span data-stu-id="a1536-231">In some cases, Power BI administrators can request that dataset owners create a less volatile query workload by creating a dashboard (which queries periodically with any dataset refresh for cached tiles) instead of a report.</span></span> <span data-ttu-id="a1536-232">ซึ่งสามารถช่วยป้องกันอัตราการเพิ่มขึ้นอย่างรวดเร็วทันทีทันใดเมื่อโหลดแดชบอร์ด</span><span class="sxs-lookup"><span data-stu-id="a1536-232">This can help prevent spikes when the dashboard is loaded.</span></span> <span data-ttu-id="a1536-233">โซลูชันนี้อาจไม่สามารถทำได้สำหรับความต้องการทางธุรกิจที่กำหนดไว้ อย่างไรก็ตามอาจเป็นวิธีที่มีประสิทธิภาพในการหลีกเลี่ยงความอิ่มตัวของ CPU โดยไม่มีการเปลี่ยนแปลงชุดข้อมูล</span><span class="sxs-lookup"><span data-stu-id="a1536-233">This solution may not always be possible for given business requirements, however it can be an effective way to avoid CPU saturation, without making changing to the dataset.</span></span>

> [!NOTE]
> <span data-ttu-id="a1536-234">สำหรับ Premium Gen2 การใช้งานเวลาของ CPU จะถูกติดตามในระดับต่ออาร์ทิแฟกต์และสามารถมองเห็นได้ในแอปการใช้ความจุ</span><span class="sxs-lookup"><span data-stu-id="a1536-234">For Premium Gen2, CPU time utilization is tracked on a per-artifact level, and is visible in the capacity utilization app.</span></span> <span data-ttu-id="a1536-235">อาร์ทิแฟกต์แต่ละรายการจะแสดงการใช้เวลา CPU ทั้งหมดตามช่วงเวลาที่กำหนด</span><span class="sxs-lookup"><span data-stu-id="a1536-235">Each artifact displays their total CPU time utilization on a given timespan.</span></span> <span data-ttu-id="a1536-236">สำหรับข้อมูลเพิ่มเติมเกี่ยวกับ Premium Gen2 โปรดดูที่ [Power BI Premium Generation 2 (ตัวอย่าง)](service-premium-what-is.md#power-bi-premium-generation-2-preview)</span><span class="sxs-lookup"><span data-stu-id="a1536-236">For more information about Premium Gen2, see [Power BI Premium Generation 2 (preview)](service-premium-what-is.md#power-bi-premium-generation-2-preview).</span></span>

## <a name="acknowledgments"></a><span data-ttu-id="a1536-237">กิตติกรรมประกาศ</span><span class="sxs-lookup"><span data-stu-id="a1536-237">Acknowledgments</span></span>

<span data-ttu-id="a1536-238">บทความนี้เขียนโดย Peter Myers, MVP แพลตฟอร์มข้อมูล และผู้เชี่ยวชาญ BI อิสระด้วย [โซลูชันแบบ Bitwise](https://www.bitwisesolutions.com.au/)</span><span class="sxs-lookup"><span data-stu-id="a1536-238">This article was written by Peter Myers, Data Platform MVP and independent BI expert with [Bitwise Solutions](https://www.bitwisesolutions.com.au/).</span></span>

## <a name="next-steps"></a><span data-ttu-id="a1536-239">ขั้นตอนถัดไป</span><span class="sxs-lookup"><span data-stu-id="a1536-239">Next steps</span></span>

> [!div class="nextstepaction"]
> <span data-ttu-id="a1536-240">[ตรวจสอบความจุ Premium ด้วยแอป](service-admin-premium-monitor-capacity.md)  </span><span class="sxs-lookup"><span data-stu-id="a1536-240">[Monitor Premium capacities with the app](service-admin-premium-monitor-capacity.md)  </span></span>  
> [!div class="nextstepaction"]
> [<span data-ttu-id="a1536-241">ตรวจสอบความจุในพอร์ทัลผู้ดูแลระบบ</span><span class="sxs-lookup"><span data-stu-id="a1536-241">Monitor capacities in the Admin portal</span></span>](service-admin-premium-monitor-portal.md)   

<span data-ttu-id="a1536-242">มีคำถามเพิ่มเติมหรือไม่</span><span class="sxs-lookup"><span data-stu-id="a1536-242">More questions?</span></span> [<span data-ttu-id="a1536-243">ลองถามชุมชน Power BI</span><span class="sxs-lookup"><span data-stu-id="a1536-243">Try asking the Power BI Community</span></span>](https://community.powerbi.com/)

<span data-ttu-id="a1536-244">Power BI ได้แนะนำ Power BI Premium Gen2 เข้ามาใช้งานเป็นข้อเสนอการแสดงตัวอย่าง ซึ่งปรับปรุงประสบการณ์การใช้งาน Power BI Premium ด้วยการปรับปรุงในสิ่งต่อไปนี้:</span><span class="sxs-lookup"><span data-stu-id="a1536-244">Power BI has introduced Power BI Premium Gen2 as a preview offering, which improves the Power BI Premium experience with improvements in the following:</span></span>
* <span data-ttu-id="a1536-245">ประสิทธิภาพการทำงาน</span><span class="sxs-lookup"><span data-stu-id="a1536-245">Performance</span></span>
* <span data-ttu-id="a1536-246">สิทธิการใช้งานต่อผู้ใช้</span><span class="sxs-lookup"><span data-stu-id="a1536-246">Per-user licensing</span></span>
* <span data-ttu-id="a1536-247">ขนาดใหญ่ขึ้น</span><span class="sxs-lookup"><span data-stu-id="a1536-247">Greater scale</span></span>
* <span data-ttu-id="a1536-248">เมตริกที่ดีขึ้น</span><span class="sxs-lookup"><span data-stu-id="a1536-248">Improved metrics</span></span>
* <span data-ttu-id="a1536-249">การปรับขนาดอัตโนมัติ</span><span class="sxs-lookup"><span data-stu-id="a1536-249">Autoscaling</span></span>
* <span data-ttu-id="a1536-250">ลดค่าใช้จ่ายในการจัดการ</span><span class="sxs-lookup"><span data-stu-id="a1536-250">Reduced management overhead</span></span>

<span data-ttu-id="a1536-251">สำหรับข้อมูลเพิ่มเติมเกี่ยวกับ Power BI Premium Gen2 โปรดดูที่ [Power BI Premium Generation 2 (ตัวอย่าง)](service-premium-what-is.md#power-bi-premium-generation-2-preview)</span><span class="sxs-lookup"><span data-stu-id="a1536-251">For more information about Power BI Premium Gen2, see [Power BI Premium Generation 2 (preview)](service-premium-what-is.md#power-bi-premium-generation-2-preview).</span></span>

